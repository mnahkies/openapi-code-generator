(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8994],{8994:(e,t,n)=>{"use strict";n.d(t,{default:()=>P});var s=n(54568),a=n(46491),i=n.n(a);let r=()=>(0,s.jsx)("span",{className:i().loader}),l=["petstore-expanded.yaml","okta.oauth.yaml","api.github.com.yaml","stripe.yaml"];var o=n(7620),p=n(61938);function u(e){let{field:t}=(0,p.as)(e);return(0,o.useEffect)(()=>{t.value!==e.values[0]&&e.values[0]&&!e.values.includes(t.value)&&t.onChange({target:{value:e.values[0]}})},[t.value,t.onChange,e.values]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{htmlFor:t.name,children:e.label}),(0,s.jsx)("select",{id:t.name,onChange:t.onChange,value:t.value,children:e.values.map(e=>(0,s.jsx)("option",{value:e,children:e||"(default)"},e))})]})}var c=n(20378);let d=async(e,t,n)=>{let s="file:///";for(let t of(e.languages.typescript.typescriptDefaults.setCompilerOptions({...e.languages.typescript.typescriptDefaults.getCompilerOptions(),moduleResolution:e.languages.typescript.ModuleResolutionKind.NodeJs,target:e.languages.typescript.ScriptTarget.ES2020,allowSyntheticDefaultImports:!0,esModuleInterop:!0,rootDir:s}),({"typescript-angular":[],"typescript-fetch":[{uri:"https://unpkg.com/@nahkies/typescript-fetch-runtime@latest/package.json",path:"/node_modules/@nahkies/typescript-fetch-runtime/package.json"},{uri:"https://unpkg.com/@nahkies/typescript-fetch-runtime@latest/dist/main.d.ts",path:"/node_modules/@nahkies/typescript-fetch-runtime/main.d.ts"},{uri:"https://unpkg.com/@nahkies/typescript-fetch-runtime@latest/dist/zod.d.ts",path:"/node_modules/@nahkies/typescript-fetch-runtime/zod.d.ts"},{uri:"https://unpkg.com/@nahkies/typescript-fetch-runtime@latest/dist/joi.d.ts",path:"/node_modules/@nahkies/typescript-fetch-runtime/joi.d.ts"},{uri:"https://unpkg.com/@nahkies/typescript-fetch-runtime@latest/dist/common.d.ts",path:"/node_modules/@nahkies/typescript-fetch-runtime/common.d.ts"},{uri:"https://unpkg.com/@nahkies/typescript-fetch-runtime@latest/dist/types.d.ts",path:"/node_modules/@nahkies/typescript-fetch-runtime/types.d.ts"}],"typescript-axios":[{uri:"https://unpkg.com/@nahkies/typescript-axios-runtime@latest/package.json",path:"/node_modules/@nahkies/typescript-axios-runtime/package.json"},{uri:"https://unpkg.com/@nahkies/typescript-axios-runtime@latest/dist/main.d.ts",path:"/node_modules/@nahkies/typescript-axios-runtime/main.d.ts"}],"typescript-koa":[{uri:"https://unpkg.com/@nahkies/typescript-koa-runtime@latest/package.json",path:"/node_modules/@nahkies/typescript-koa-runtime/package.json"},{uri:"https://unpkg.com/@nahkies/typescript-koa-runtime@latest/dist/server.d.ts",path:"/node_modules/@nahkies/typescript-koa-runtime/server.d.ts"},{uri:"https://unpkg.com/@nahkies/typescript-koa-runtime@latest/dist/errors.d.ts",path:"/node_modules/@nahkies/typescript-koa-runtime/errors.d.ts"},{uri:"https://unpkg.com/@nahkies/typescript-koa-runtime@latest/dist/zod.d.ts",path:"/node_modules/@nahkies/typescript-koa-runtime/zod.d.ts"},{uri:"https://unpkg.com/@nahkies/typescript-koa-runtime@latest/dist/joi.d.ts",path:"/node_modules/@nahkies/typescript-koa-runtime/joi.d.ts"}]})[n])){let n=e.Uri.file(t.path);if(!e.editor.getModel(n)){let s=await (await fetch(t.uri)).text();console.info("createModel for ".concat(n.path)),e.editor.createModel(s,"typescript",n)}}return c.AutoTypings.create(t,{monaco:e,fileRootPath:s,sourceCache:new c.LocalStorageCache,onUpdate:e=>console.log("progress",e),onError:e=>console.error(e),dontAdaptEditorOptions:!0,preloadPackages:!0,shareCache:!0,versions:{zod:"3.24.1"}})};function m(e,t){null==e||e.postMessage(t)}var h=n(90060),g=n(27855),f=n(22046),y=n(69790),x=n(90599),k=n(20880),j=n(64752),v=n.n(j);function b(e){let{field:t}=(0,p.as)(e);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("label",{htmlFor:t.name,children:e.label}),(0,s.jsx)("input",{id:t.name,type:"checkbox",checked:t.value,onChange:t.onChange})]})}var S=n(62432),w=n.n(S);let C=f.Qn.pick({template:!0,schemaBuilder:!0,enableRuntimeResponseValidation:!0,enableTypedBasePaths:!0,extractInlineSchemas:!0,groupingStrategy:!0,tsAllowAny:!0,tsServerImplementationMethod:!0,enumExtensibility:!0}),_=e=>{let{config:t,setConfig:n}=e,{control:a,watch:i}=(0,p.mN)({resolver:(0,h.u)(C),defaultValues:{template:t.template,schemaBuilder:t.schemaBuilder,enableRuntimeResponseValidation:t.enableRuntimeResponseValidation,enableTypedBasePaths:t.enableTypedBasePaths,extractInlineSchemas:t.extractInlineSchemas,groupingStrategy:t.groupingStrategy,tsAllowAny:t.tsAllowAny,tsServerImplementationMethod:t.tsServerImplementationMethod,enumExtensibility:t.enumExtensibility}});return(0,o.useEffect)(()=>{let{unsubscribe:e}=i(e=>{n({...t,...e})});return()=>e()},[i,t,n]),(0,s.jsxs)("div",{className:w().container,children:[(0,s.jsx)(u,{name:"template",control:a,label:"--template",values:C.shape.template.options},"template"),(0,s.jsx)(u,{name:"schemaBuilder",control:a,label:"--schema-builder",values:C.shape.schemaBuilder.options}),(0,s.jsx)(b,{label:"--enable-runtime-response-validation",name:"enableRuntimeResponseValidation",control:a}),(0,s.jsx)(b,{label:"--enable-typed-base-paths",name:"enableTypedBasePaths",control:a}),(0,s.jsx)(b,{label:"--extract-inline-schemas",name:"extractInlineSchemas",control:a}),(0,s.jsx)(b,{label:"--ts-allow-any",name:"tsAllowAny",control:a}),(0,s.jsx)(u,{name:"tsServerImplementationMethod",control:a,label:"--ts-server-implementation-method",values:C.shape.tsServerImplementationMethod.options}),(0,s.jsx)(u,{name:"groupingStrategy",control:a,label:"--grouping-strategy",values:C.shape.groupingStrategy.options}),(0,s.jsx)(u,{name:"enumExtensibility",control:a,label:"--enum-extensibility",values:C.shape.enumExtensibility.options})]})},M=async e=>{try{let t=await fetch("/samples/".concat(e)),n=await t.text();if(t.ok)return n;return"Failed to load sample. ".concat(n)}catch(e){return"Failed to load sample. ".concat(e instanceof Error?e.message:e)}},E={input:"/example.yaml",output:"/generated",template:"typescript-fetch",inputType:"openapi3",schemaBuilder:"zod",enableRuntimeResponseValidation:!0,extractInlineSchemas:!0,allowUnusedImports:!1,groupingStrategy:"first-tag",tsAllowAny:!1,tsCompilerOptions:{exactOptionalPropertyTypes:!1},enableTypedBasePaths:!0,filenameConvention:"kebab-case",tsServerImplementationMethod:"type",enumExtensibility:""},R=e=>{let{children:t}=e;return(0,s.jsx)("div",{style:{display:"flex",gap:"0.5rem",margin:"0.5rem 0"},children:t})},A=e=>{let{editor:t}=e,n=(0,o.useCallback)(()=>{null==t||t.trigger("fold","editor.foldAll",void 0)},[t]),a=(0,o.useCallback)(()=>{null==t||t.trigger("fold","editor.unfoldAll",void 0)},[t]);return(0,s.jsx)("div",{style:{display:"flex",flexDirection:"column",marginTop:"0.5rem",alignItems:"center"},children:(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"row",gap:"1rem"},children:[(0,s.jsx)("button",{type:"button",onClick:n,children:"Fold All"}),(0,s.jsx)("button",{type:"button",onClick:a,children:"Unfold All"})]})})},I=e=>{let{result:t}=e;if(!t||t.loading)return(0,s.jsx)(x.P,{type:"info",emoji:"✅",children:(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Running generation"}),(0,s.jsx)("br",{}),(0,s.jsx)(r,{})]})});if(t.success){let{elapsed:e}=t.result;return(0,s.jsx)(x.P,{type:"info",emoji:"✅",children:(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Generation success"}),(0,s.jsx)("br",{}),"Generation ran in ",e,"ms"]})})}if(!t.success){let e=t.err,n=t.err.cause;return(0,s.jsx)(x.P,{type:"warning",emoji:"⚠️",children:(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:e.message}),(0,s.jsx)("br",{}),n instanceof Error?"Details: ".concat(n.message):null]})})}return null},F=e=>{let{monaco:t,webFsAdaptor:a,defaultSample:i,samples:r}=e,l=(0,y.R)(),c=(0,o.useRef)(null),[f,x]=(0,o.useState)(E),[j,b]=(0,o.useState)(null),[S,w]=(0,o.useState)(),[C,F]=(0,o.useState)(),[P,V]=(0,o.useState)([]),B=t.editor.getModel(t.Uri.file(f.input)),{control:D,watch:O}=(0,p.mN)({resolver:(0,h.u)(k.z.object({input:k.z.string(),output:k.z.string().optional()})),defaultValues:{input:i.filename,output:""}}),T=O("input"),z=O("output");(0,o.useEffect)(()=>(c.current||(c.current=new Worker(n.tu(new URL(n.p+n.u(7022),n.b)))),!function(e,t){e.onmessage=e=>{console.info("received event from worker",e),t(e.data)},e.onerror=e=>{console.info("received error event from worker",e)}}(c.current,async e=>{if(e.success){for(let[n,s]of(a.clearFiles(e=>e.includes("/generated/")),e.result.files))await a.writeFile(n,s),function(e,t){let{filename:n,value:s}=e,a=t.Uri.file(n),i=n.endsWith(".ts")?"typescript":"yaml";if(t.editor.getModel(a)){var r;null===(r=t.editor.getModel(a))||void 0===r||r.setValue(s)}else t.editor.createModel(s,i,a)}({filename:n,value:s},t);V(t.editor.getModels().filter(e=>e.uri.path.includes("/generated/")&&a.existsSync(e.uri.path)).map(e=>e.uri.path))}b(e)}),()=>{c.current&&(c.current.terminate(),c.current=null)}),[a,t]);let U=(0,o.useCallback)(e=>w(e),[]),N=(0,o.useCallback)(e=>F(e),[]);return(0,o.useEffect)(()=>{if(!S)return;let e=t.Uri.file(f.input);t.editor.getModel(e)||(t.editor.createModel(i.content,"yaml",e),m(c.current,{type:"generate",config:f,input:i.content}));let n=t.editor.getModel(e);if(S.setModel(n),!n)return;let s=n.onDidChangeContent(()=>{console.info("input changed");let e=n.getValue();e&&m(c.current,{type:"generate",config:f,input:e})});return()=>{s.dispose()}},[t,S,f,i]),(0,o.useEffect)(()=>{let e=r.find(e=>e===T);!(!e||!B||B.isDisposed())&&(B.setValue("Loading..."),M(e).then(e=>B.setValue(e)))},[T,B,r]),(0,o.useEffect)(()=>{let e=z&&t.editor.getModel(t.Uri.file(z));!(!C||!e||e.isDisposed())&&C.getModel()!==e&&C.setModel(e)},[z,C,t]),(0,o.useEffect)(()=>{let e;if(C)return d(t,C,f.template).then(t=>{e=t}).catch(e=>{b({success:!1,loading:!1,err:Error("Failed to load typescript typings",{cause:e})})}),()=>null==e?void 0:e.dispose()},[f.template,t,C]),(0,o.useEffect)(()=>{let e=null==B?void 0:B.getValue();e&&m(c.current,{type:"generate",config:f,input:e})},[f,B]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.h3,{children:"Configuration"}),(0,s.jsx)(_,{config:f,setConfig:x}),(0,s.jsxs)("div",{className:v().editorContainer,children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.h3,{children:"Input Specification"}),(0,s.jsx)(R,{children:(0,s.jsx)(u,{label:"Sample Specification",values:r,name:"input",control:D})}),(0,s.jsx)(g.KE,{height:"30vh",onMount:U,options:{theme:"vs-dark",minimap:{enabled:!1}}}),(0,s.jsx)(A,{editor:S}),(0,s.jsx)(I,{result:j})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.h3,{children:"Output"}),(0,s.jsx)(R,{children:(0,s.jsx)(u,{label:"Output File",values:null!=P?P:[""],name:"output",control:D})}),(0,s.jsx)(g.KE,{height:"30vh",defaultLanguage:"typescript",options:{theme:"vs-dark",minimap:{enabled:!1},domReadOnly:!0,readOnly:!0},onMount:N}),(0,s.jsx)(A,{editor:C})]})]})]})},P=()=>{let e=(0,g.dJ)(),[t]=(0,o.useState)(new f.Rj),n=l[0],[a,i]=(0,o.useState)(null);return((0,o.useEffect)(()=>{M(n).then(e=>i({filename:n,content:e}))},[n]),e&&a)?(0,s.jsx)(F,{monaco:e,webFsAdaptor:t,defaultSample:a,samples:l}):null}},22046:(e,t,n)=>{"use strict";t.Rj=t.Qn=void 0;let s=n(5558),a=n(32865),i=n(63022),r=n(20878),l=n(2901),o=n(72516);var p=n(67156);Object.defineProperty(t,"Qn",{enumerable:!0,get:function(){return p.configSchema}}),n(65829);var u=n(45505);Object.defineProperty(t,"Rj",{enumerable:!0,get:function(){return u.WebFsAdaptor}}),n(14497),n(91445),n(49909)},46491:e=>{e.exports={loader:"loading-spinner_loader__iwj1w",rotation:"loading-spinner_rotation__fDCh2"}},62432:e=>{e.exports={container:"config-form_container__wMxrZ"}},64752:e=>{e.exports={editorContainer:"playground_editorContainer__4wS4H"}}}]);