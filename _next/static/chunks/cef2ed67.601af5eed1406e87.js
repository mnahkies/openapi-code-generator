"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2053],{46903:(e,t,n)=>{n.d(t,{Dt:()=>P,HF:()=>A,wj:()=>I,zN:()=>N});var r,a=n(49402),o=n(71050),i=n(59526),l=n(93210),s=n(86538),d=n(71644),u=n(56342),c=n(58985),p=n(42666),m=n(84972),f=n(16706),y=n(1596),g=n(5133),v=n(89538),k=n(21991),b=n(14840),T=n(14383),h=n(23415),x=n(26985),S=n(77360),M=n(15209);let w=class extends s.$V{};function I(e,t){let n={},a=new WeakMap,o=new Map,I=new WeakMap,P=new WeakMap,A=t=>{e.reportDiagnostic(t)},V={},R=function(){let e=t.symbols.global,n=to({kind:"Namespace",name:"",node:t.symbols.global.declarations[0],models:new Map,scalars:new Map,operations:new Map,namespaces:new Map,interfaces:new Map,unions:new Map,enums:new Map,decoratorDeclarations:new Map,functionDeclarations:new Map,decorators:[]});return eP(e).type=n,n.decorators=e1(e,n,void 0),ti(n)}(),B=new Map,F=to({kind:"Intrinsic",name:"ErrorType"}),$=to({kind:"Intrinsic",name:"void"}),Q=to({kind:"Intrinsic",name:"never"}),z=to({kind:"Intrinsic",name:"unknown"}),G=to({kind:"Intrinsic",name:"null"}),X=new j,q=t.symbols.global.exports.get("TypeSpec");q&&((0,s.Tk)(q.exports).set("log",{flags:2048,name:"log",value:(t,...n)=>(e.trace("log",n.join(" ")),$),declarations:[],node:void 0}),(0,s.Tk)(t.symbols.null).type=G,eP(t.symbols.null).type=G);let H=new Map,J={getTypeForNode:en,checkProgram:function(){for(let n of(function(){for(let n of(e.reportDuplicateSymbols(t.symbols.global.exports),e.sourceFiles.values()))for(let t of n.namespaces){let n=ts(t.symbol).exports??t.symbol.exports;e.reportDuplicateSymbols(n)}}(),e.sourceFiles.values()))for(let r of(function(n){let r=new Map;for(let e of n.usings){let n=function(e){let t=r.get(e);if(t)return t;let n=new l.i;return r.set(e,n),n}(ts(e.parent.symbol)),a=t.getNodeLinks(e.name).resolvedSymbol;a&&n.track(a,e)}for(let t of r.values())for(let[n,r]of t.entries())for(let t of r)e.reportDiagnostic((0,b.o)({code:"duplicate-using",format:{usingName:(0,g.q5)(t.name)},target:t}))}(n),n.namespaces))ew(r);for(let t of e.sourceFiles.values())eK(t);(0,f.JN)(e)},checkSourceFile:eK,getLiteralType:tl,getGlobalNamespaceType:function(){return R},cloneType:tu,resolveRelatedSymbols:function(e,n){let r,{node:a,kind:o}=(0,h.fe)(e);switch(o){case M.wp.ModelExpressionProperty:case M.wp.ObjectLiteralProperty:return eN(a).map(t=>te(t.node.symbol,e.sv)).filter(e=>void 0!==e);case M.wp.ModelStatementProperty:case M.wp.Declaration:let i=t.getNodeLinks(e);return void 0===i.resolvedSymbol?void 0:[i.resolvedSymbol];case M.wp.Other:return;case M.wp.Decorator:case M.wp.Function:case M.wp.Using:case M.wp.TypeReference:let l=e,s=o===M.wp.Decorator;e.parent?.kind===M.a6.MemberExpression&&(e.parent.id===e?l=e.parent:s=!1),r=eV(l,n,s);break;case M.wp.TemplateArgument:let d=eA(a,n).flatMap(e=>e.templateParameters).find(t=>t.id.sv===e.sv);d&&(r=ts(d.symbol));break;default:(0,m.a7)(!1,"Unreachable")}if(r)if(r.symbolSource)return[r.symbolSource];else return[r]},resolveCompletions:function(n){let r=new Map,{kind:a,node:o}=(0,h.fe)(n);switch(a){case M.wp.Using:case M.wp.Decorator:case M.wp.Function:case M.wp.TypeReference:case M.wp.ModelExpressionProperty:case M.wp.ModelStatementProperty:case M.wp.ObjectLiteralProperty:break;case M.wp.Other:case M.wp.Declaration:return r;case M.wp.TemplateArgument:for(let e of eA(o,void 0))for(let t of e.templateParameters)l(t.id.sv,t.symbol);return r;default:(0,m.a7)(!1,"Unreachable")}if(a===M.wp.ModelStatementProperty){let t=o.parent,a=e.checker.getTypeForNode(t),i=a.baseModel,s=i?.node;if(!s)return r;for(let e of i.properties.values())if(n.sv===e.name||!a.properties.has(e.name)){let t=te(s.symbol,e.name);t&&l(e.name,t)}}else if(a===M.wp.ModelExpressionProperty||a===M.wp.ObjectLiteralProperty){let e=eN(o);if(e.length<=0)return r;let t=o.parent;for(let r of e)for(let e of N(r))if(n.sv===e.name||!t.properties.find(t=>(t.kind===M.a6.ModelProperty||t.kind===M.a6.ObjectLiteralProperty)&&t.id.sv===e.name)){let t=te(r.node.symbol,e.name);t&&l(e.name,t)}}else if(n.parent&&n.parent.kind===M.a6.MemberExpression){let e=t.getNodeLinks(n.parent.base).resolvedSymbol;if(e&&(128&e.flags&&(e=eD(e,void 0)),e))if("::"===n.parent.selector)if(e?.node===void 0&&e?.declarations&&e.declarations.length>0){let t=e?.declarations[0];t.kind===M.a6.OperationStatement&&(l("parameters",t.symbol),l("returnType",t.symbol))}else e?.node?.kind===M.a6.ModelProperty&&l("type",e.node.symbol);else i(e.exports??e.members)}else{if(a===M.wp.TypeReference&&(0,h.Px)(o)&&o.parent?.kind===M.a6.TemplateArgument&&void 0===o.parent.name)for(let e of eA(o.parent,void 0))for(let t of e.templateParameters)l(t.id.sv,t.symbol,{suffix:" = "});let e=n.parent;for(;e&&e.kind!==M.a6.TypeSpecScript;)e.symbol&&e.symbol.exports&&i(ts(e.symbol).exports),"locals"in e&&i(e.locals),e=e.parent;if(e&&e.kind===M.a6.TypeSpecScript){for(let t of e.inScopeNamespaces)i(ts(t.symbol).exports);i(t.symbols.global.exports),i(e.locals)}}return r;function i(e){if(e)for(let[n,r]of e=t.getAugmentedSymbolTable(e))if(16384&r.flags)for(let t of e.duplicates.get(r))8192&t.flags&&l((0,S.eN)(t.symbolSource),t);else l(n,r)}function l(e,t,n={}){t.symbolSource&&(t=t.symbolSource),function(e){switch(a){case M.wp.ModelExpressionProperty:case M.wp.ModelStatementProperty:case M.wp.ObjectLiteralProperty:return!!(65536&e.flags);case M.wp.Decorator:return!!(768&e.flags);case M.wp.Using:return!!(256&e.flags);case M.wp.TypeReference:return!(2560&e.flags);case M.wp.TemplateArgument:return!!(1024&e.flags);default:(0,m.a7)(!1,"We should have bailed up-front on other kinds.")}}(t)&&(e.startsWith("@")&&(e=e.slice(1)),r.has(e)||r.set(e,{...n,sym:t}))}},neverType:Q,errorType:F,nullType:G,anyType:z,voidType:$,typePrototype:V,createType:to,createAndFinishType:ta,createLiteralType:tp,finishType:ti,isStdType:function(e,t){return("Model"===e.kind||"Scalar"===e.kind)&&void 0!==e.namespace&&!!ec(e.namespace)&&("Scalar"===e.kind?void 0===t||t===e.name:"Array"===t&&e===n.Array||"Record"===t&&e===n.Record||"Model"===e.kind&&(void 0===t||t===e.name))},getStdType:Z,resolveTypeReference:function(e){let t=A,n=[];A=e=>n.push(e);let r=ef(e,void 0,!1);return A=t,[r===F?void 0:r,n]},getValueForNode:er,getTypeOrValueForNode:el,getValueExactType:function(e){return P.get(e)},getTemplateParameterUsageMap:function(){return H},isTypeAssignableTo:void 0},W=(0,x.i)(e,J);return J.isTypeAssignableTo=W.isTypeAssignableTo,J;function _(e,t){A(void 0===t||"object"!=typeof e.target?e:{...e,target:{node:e.target,templateMapper:t}})}function Y(e){e.forEach(e=>_(e))}function Z(e){let t=n[e];if(void 0!==t)return t;let r=q?.exports?.get(e);(0,m.a7)(r,`Unexpected missing symbol to std type "${e}"`),2&r.flags?ej(r.declarations[0],void 0):e4(r.declarations[0],void 0);let a=n[e];return(0,m.a7)(a,`TypeSpec std type "${e}" should have been initalized before using array syntax.`),a}function ee(e,t,n){void 0===n?(e.declaredType=t,e.instantiations=new w):e.instantiations&&e.instantiations.set(n.args,t)}function et(e,t){let n=eP(e),r=en((0,d.gG)(e.parent),t),a=n.declaredType??n.type;return a||function(e,t,n){switch(e.kind){case M.a6.ModelProperty:return eY(e,t);case M.a6.EnumMember:return tr(e,t,n);case M.a6.OperationStatement:return eE(e,t,n);case M.a6.UnionVariant:return e9(e,t);case M.a6.ScalarConstructor:return e2(e,t,n)}}((0,d.gG)(e),t,r)}function en(e,t){let n=ed(e,t);return null===n?F:"Indeterminate"===n.entityKind?n.type:(0,S.ml)(n)?(_((0,b.o)({code:"value-in-type",target:e})),F):("TemplateParameter"===n.kind&&n.constraint?.valueType&&_((0,b.o)({code:"value-in-type",messageId:"referenceTemplate",target:e})),n)}function er(e,t,n,r={}){var a,o;let i,l=ed(e,t,n);return null===l||null===(i="Indeterminate"===l.entityKind?ea(l.type,n,e):l)?null:(0,S.ml)(i)?n?function(e,t){switch(e.valueKind){case"BooleanValue":case"StringValue":case"NumericValue":if(void 0===e.scalar){let n=ez(t,e.type);return eQ(e,{scalar:n})}return e;case"ArrayValue":case"ObjectValue":case"EnumValue":case"NullValue":case"ScalarValue":return e}}(i,n.type):i:(a=e,"Model"===(o=i).kind&&""===o.name&&a.kind===M.a6.ModelExpression?_((0,b.o)({code:"expect-value",messageId:"model",format:{name:(0,v.Uz)(o)},codefixes:[(0,c.l)(a)],target:a})):"Tuple"===o.kind&&a.kind===M.a6.TupleExpression?_((0,b.o)({code:"expect-value",messageId:"tuple",format:{name:(0,v.Uz)(o)},codefixes:[(0,c.s)(a)],target:a})):_((0,b.o)({code:"expect-value",format:{name:(0,v.Uz)(o)},target:a})),null)}function ea(e,t,n){switch(e.kind){case"String":case"StringTemplate":return eG(e,t,n);case"Number":var r,a,o,i,l,s,d=e,u=t,c=n;if(u&&!tm(d,u,c))return null;let p=ez(u?.type,d);return e$({entityKind:"Value",valueKind:"NumericValue",value:(0,T.ew)(d.valueAsString),type:u?u.type:d,scalar:p},d);case"Boolean":var m=e,f=t,y=n;if(f&&!tm(m,f,y))return null;let g=ez(f?.type,m);return e$({entityKind:"Value",valueKind:"BooleanValue",value:m.value,type:f?f.type:m,scalar:g},m);case"EnumMember":return r=e,a=t,o=n,a&&!tm(r,a,o)?null:e$({entityKind:"Value",valueKind:"EnumValue",type:a?a.type:r,value:r},r);case"UnionVariant":return ea(e.type,t,n);case"Intrinsic":if("null"===e.name){return i=e,l=t,s=n,l&&!tm(i,l,s)?null:e$({entityKind:"Value",valueKind:"NullValue",type:l?l.type:i,value:null},i)}return e;default:return e}}function eo(e){var t,n;switch(e.kind){case"Tuple":return(t=e).node.kind!==M.a6.TupleExpression?t:(_((0,b.o)({code:"expect-value",codefixes:[(0,c.s)(t.node)],messageId:"tuple",target:t.node})),null);case"Model":return n=e,n.node?.kind!==M.a6.ModelExpression?n:(_((0,b.o)({code:"expect-value",codefixes:[(0,c.l)(n.node)],messageId:"modelExpression",target:n.node})),null);default:return e}}function ei(e){return!!(e?.valueType&&!e.type)}function el(e,t,n){let r=es(n),a=ed(e,t,r);if(null===a)return a;if((0,S.Xj)(a))if(ei(n?.constraint))return eo(a);else return a;if((0,S.ml)(a))return a;if((0,m.a7)("Indeterminate"===a.entityKind,"Expected indeterminate entity"),r){let t=[],n=A;A=e=>t.push(e);let o=ea(a.type,r,e);if(A=n,o)return Y(t),o}return a.type}function es(e){return e?.constraint.valueType?{kind:e.kind,type:e.constraint.valueType}:void 0}function ed(n,a,o){switch(n.kind){case M.a6.ModelExpression:case M.a6.ModelStatement:return i=n,l=a,i.kind===M.a6.ModelStatement?ej(i,l):function(e,t){let n=eP(e.symbol);if(n.declaredType&&void 0===t)return n.declaredType;let r=(0,s.nQ)(),a=to({kind:"Model",name:"",node:e,properties:r,indexer:void 0,namespace:eI(e),decorators:[],derivedModels:[],sourceModels:[]});return ee(n,a,t),D(a,t),eF(e,r,a,t),ti(a)}(i,l);case M.a6.ModelProperty:return eY(n,a);case M.a6.ScalarStatement:return e4(n,a);case M.a6.AliasStatement:return e5(n,a);case M.a6.EnumStatement:var i,l,u,c,p,f,y,g,k=n,T=a;let h=eP(k.symbol);if(!h.type){let e=h.type=to({kind:"Enum",name:k.id.sv,node:k,members:(0,s.nQ)(),decorators:[]}),t=new Set;for(let n of k.members)if(n.kind===M.a6.EnumMember){let r=tr(n,T,e);if(t.has(r.name)){_((0,b.o)({code:"enum-member-duplicate",format:{name:r.name},target:k}));continue}t.add(r.name),e.members.set(r.name,r)}else for(let r of function(e,t,n,r,a){let o=[],i=en(n,r);if(!(0,S.xg)(i)){if("Enum"!==i.kind)return _((0,b.o)({code:"spread-enum",target:n})),o;for(let r of i.members.values())if(a.has(r.name))_((0,b.o)({code:"enum-member-duplicate",format:{name:r.name},target:n}));else{a.add(r.name);let n=tc(te(e,r.name),r,{enum:t,sourceMember:r});n&&o.push(n)}}return o}(k.symbol,e,n.target,T,t))e_(k,r,T),e.members.set(r.name,r);e.namespace=eI(k),e.namespace?.enums.set(e.name,e),e.decorators=e7(e,k,T),D(e,T),ti(e)}return h.type;case M.a6.EnumMember:return tr(n,a);case M.a6.InterfaceStatement:return e3(n,a);case M.a6.UnionStatement:return e8(n,a);case M.a6.UnionVariant:return e9(n,a);case M.a6.NamespaceStatement:case M.a6.JsNamespaceDeclaration:return function e(t){let n=eP(ts(t.symbol)).type;if(n||(n=ew(t)),t.kind===M.a6.NamespaceStatement){if((0,s.cy)(t.statements))t.statements.forEach(e=>ed(e));else if(t.statements){let r=e(t.statements);n.namespaces.set(r.name,r)}}return n}(n);case M.a6.OperationStatement:return eE(n,a);case M.a6.NumericLiteral:case M.a6.BooleanLiteral:case M.a6.StringLiteral:return eU(tl(n));case M.a6.TupleExpression:return u=n,c=a,ta({kind:"Tuple",node:u,values:u.values.map(e=>en(e,c))});case M.a6.StringTemplateExpression:return function(e,t){let n=!1,r=!1,a=e.spans.map(e=>[e,ed(e.expression,t)]);for(let[e,t]of a)null!==t&&((0,S.ml)(t)?r=!0:"kind"in t&&"TemplateParameter"===t.kind&&t.constraint?(t.constraint.valueType&&(r=!0),t.constraint.type&&(n=!0)):n=!0);if(n&&r)return _((0,b.o)({code:"mixed-string-template",target:e})),null;if(r){let t=e.head.value;for(let[e,n]of a)null===n||"kind"in n&&"TemplateParameter"===n.kind||((0,m.a7)(null!==n&&(0,S.ml)(n),"Expected value."),t+=function(e){switch(e.valueKind){case"StringValue":case"NumericValue":case"BooleanValue":return e.value.toString();default:return _((0,b.o)({code:"non-literal-string-template",target:e})),`[${e.valueKind}]`}}(n)),t+=e.literal.value;return eG(tp(t),void 0,e)}{let t=!1,n=e.head.value,r=[eO(e.head)];for(let[e,i]of a){var o;(0,m.a7)(null!==i&&!(0,S.ml)(i),"Expected type.");let a="Indeterminate"===i.entityKind?i.type:i,l=(o=e.expression,to({kind:"StringTemplateSpan",node:o,isInterpolated:!0,type:a}));r.push(l);let s=function(e){switch(e.kind){case"String":case"Number":case"Boolean":return String(e.value);case"StringTemplate":if(void 0!==e.stringValue)return e.stringValue;return;default:return}}(a);s?n+=s:t=!0,r.push(eO(e.literal)),n+=e.literal.value}return eU(to({kind:"StringTemplate",node:e,spans:r,stringValue:t?void 0:n}))}}(n,a);case M.a6.ArrayExpression:return eM(n,a);case M.a6.UnionExpression:var x=n,w=a;let I=ta({kind:"Union",node:x,get options(){return Array.from(this.variants.values()).map(e=>e.type)},expression:!0,variants:(0,s.nQ)(),decorators:[]});for(let e of x.options){let t=en(e,w);if(t!==Q)if("Union"===t.kind&&t.expression)for(let[e,n]of t.variants)I.variants.set(e,n);else{let e=to({kind:"UnionVariant",type:t,name:Symbol("name"),decorators:[],node:void 0,union:I});I.variants.set(e.name,e)}}return D(I,w),I;case M.a6.IntersectionExpression:var E=n,P=a;let A=eP(E.symbol);if(A.declaredType&&void 0===P)return A.declaredType;let V=E.options.map(e=>[e,en(e,P)]),U=function e(t,n,r,a){let o=(0,s.nQ)(),i=to({kind:"Model",node:n,name:"",namespace:eI(n),properties:o,decorators:[],derivedModels:[],sourceModels:[]}),l=[],d=r.filter(e=>{let[t,n]=e;return"TemplateParameter"!==n.kind&&("Model"===n.kind||(_((0,b.o)({code:"intersect-non-model",target:t})),!1))});for(let[e,t]of d)t.indexer&&("integer"===t.indexer.key.name?_((0,b.o)({code:"intersect-invalid-index",messageId:"array",target:e})):l.push(t.indexer));for(let[e,r]of d)for(let e of(i.sourceModels.push({usage:"intersection",model:r}),N(r))){if(o.has(e.name)){_((0,b.o)({code:"intersect-duplicate-property",format:{propName:e.name},target:n}));continue}let s=t&&te(t,e.name),d={sourceProperty:e,model:i},u=s?tc(s,e,d):tu(e,d);for(let t of(o.set(e.name,u),e_(n,u,a),l.filter(e=>e!==r.indexer)))eB(t,e,n)}return 1===l.length?i.indexer=l[0]:l.length>1&&(i.indexer={key:l[0].key,value:e(void 0,n,l.map(e=>[e.value.node,e.value]),a)}),D(i,a),ti(i)}(E.symbol,E,V,P);return ee(A,U,P),U;case M.a6.DecoratorDeclarationStatement:return eT(n,a);case M.a6.FunctionDeclarationStatement:return p=n,f=0,_((0,b.o)({code:"function-unsupported",target:p})),F;case M.a6.TypeReference:return function(e,t,n=!0){let r=eV(e,t);return r?eg(r,e,t,n)??F:F}(n,a);case M.a6.TemplateArgument:return y=n,g=a,ed(y.argument,g);case M.a6.TemplateParameterDeclaration:return em(n,a);case M.a6.VoidKeyword:return $;case M.a6.NeverKeyword:return Q;case M.a6.UnknownKeyword:return z;case M.a6.ObjectLiteral:var O=n,K=a,L=o;let j=function(e,t){let n=new Map,r=!1;for(let a of e.properties)if("id"in a){let e=er(a.value,t);null===e?r=!0:n.set(a.id.sv,{name:a.id.sv,value:e,node:a})}else{let e=function(e,t){let n=er(e,t);return null===n?null:"ObjectValue"!==n.valueKind?(_((0,b.o)({code:"spread-object",target:e})),null):n}(a.target,t);if(e)for(let[t,r]of e.properties)n.set(t,{...r})}return r?null:n}(O,K);if(null===j)return null;let C=function(e,t){let n=to({kind:"Model",name:"",node:e,properties:(0,s.nQ)(),decorators:[],derivedModels:[],sourceModels:[]});for(let e of t.values()){var r,a;n.properties.set(e.name,(r=e,a=n,ta({kind:"ModelProperty",node:r.node,model:a,optional:!1,name:r.name,type:r.value.type,decorators:[]})))}return ti(n)}(O,j);return L&&!tm(C,L,O)?null:e$({entityKind:"Value",valueKind:"ObjectValue",node:O,properties:j,type:L?L.type:C},C);case M.a6.ArrayLiteral:return function(e,t,n){let r=!1,a=e.values.map(e=>{let n=er(e,t);return null===n&&(r=!0),n});if(r)return null;let o=ta({kind:"Tuple",node:e,values:a.map(e=>e.type)});return n&&!tm(o,n,e)?null:e$({entityKind:"Value",valueKind:"ArrayValue",node:e,values:a,type:n?n.type:o},o)}(n,a,o);case M.a6.ConstStatement:var R=n;let B=eP(R.symbol);if(void 0!==B.value)return B.value;let G=R.type?en(R.type,void 0):void 0;if(X.has(R.symbol,r.Value))return _((0,b.o)({code:"circular-const",format:{name:R.id.sv},target:R})),null;X.start(R.symbol,r.Value);let q=er(R.value,void 0,G&&{kind:"assignment",type:G});return(X.finish(R.symbol,r.Value),null===q||G&&!tf(q,G,R.id))?B.value=null:B.value=G?eQ(q,{type:G}):eQ(q),B.value;case M.a6.CallExpression:var H=n,J=a;let Y=eX(H,J);return null===Y?null:"ScalarConstructor"===Y.kind?function(e,t,n){let r=!1,a=n.parameters.filter(e=>!e.optional&&!e.rest).length??0,o=n.parameters[n.parameters.length-1]?.rest?void 0:n.parameters.length;if(e.arguments.length<a||void 0!==o&&e.arguments.length>o)if(e.arguments.length<a&&(r=!0),void 0===o)_((0,b.o)({code:"invalid-argument-count",messageId:"atLeast",format:{actual:e.arguments.length.toString(),expected:a.toString()},target:e}));else{let t=a===o?a.toString():`${a}-${o}`;_((0,b.o)({code:"invalid-argument-count",format:{actual:e.arguments.length.toString(),expected:t},target:e}))}let i=[];for(let[a,o]of n.parameters.entries()){if(o.rest){var l;let n="Model"===(l=o.type).kind?l.indexer?.value:void 0;if(n)for(let o=a;o<e.arguments.length;o++){let a=e.arguments[o];if(a){let e=er(a,t,{kind:"argument",type:n});if(null===e){r=!0;continue}tf(e,n,a)?i.push(e):r=!0}}break}let n=e.arguments[a];if(n){let e=er(n,t,{kind:"argument",type:o.type});if(null===e){r=!0;continue}tf(e,o.type,n)?i.push(e):r=!0}}return r?null:{entityKind:"Value",valueKind:"ScalarValue",value:{name:n.name,args:i},scalar:n.scalar,type:n.scalar}}(H,J,Y):W.areScalarsRelated(Y,Z("string"))?eq(H,Y,"StringValue"):W.areScalarsRelated(Y,Z("numeric"))?eq(H,Y,"NumericValue"):W.areScalarsRelated(Y,Z("boolean"))?eq(H,Y,"BooleanValue"):(_((0,b.o)({code:"named-init-required",format:{typeKind:Y.kind},target:H.target})),null);case M.a6.TypeOfExpression:var et=n,ea=a;let eo=ed(et.target,ea,void 0);if(null===eo)return F;if("Indeterminate"===eo.entityKind)return eo.type;if((0,S.Xj)(eo)){if("TemplateParameter"===eo.kind){if(void 0===eo.constraint||void 0!==eo.constraint.type)return _((0,b.o)({code:"expect-value",messageId:"templateConstraint",format:{name:(0,v.Uz)(eo)},target:et.target})),F;else if(eo.constraint.valueType)return eo.constraint.valueType}return _((0,b.o)({code:"expect-value",format:{name:(0,v.Uz)(eo)},target:et.target})),eo}return eo.type;case M.a6.AugmentDecoratorStatement:var ei=n;eV(ei.targetType,void 0);let el=t.getNodeLinks(ei.targetType);if(el.isTemplateInstantiation)e.reportDiagnostic((0,b.o)({code:"augment-decorator-target",messageId:"noInstance",target:ei.targetType}));else if(el.finalSymbol?.flags&&1048576&~el.finalSymbol.flags&&65536&~el.finalSymbol.flags)e.reportDiagnostic((0,b.o)({code:"augment-decorator-target",messageId:2&el.finalSymbol.flags?"noModelExpression":64&el.finalSymbol.flags?"noUnionExpression":"default",target:ei.targetType}));else if(el.finalSymbol?.flags&&128&el.finalSymbol.flags){let t=(0,d.gG)(el.finalSymbol);e.reportDiagnostic((0,b.o)({code:"augment-decorator-target",messageId:t.value.kind===M.a6.UnionExpression?"noUnionExpression":"default",target:ei.targetType}))}return F;case M.a6.UsingStatement:var es=n;let eu=eV(es.name,void 0);return eu&&256&~eu.flags&&_((0,b.o)({code:"using-invalid-ref",target:es.name})),F;default:return F}}function eu(e){return e.kind===M.a6.OperationStatement&&e.parent?.kind===M.a6.InterfaceStatement?tt(e):e.symbol}function ec(e){return"TypeSpec"===e.name&&e.namespace===R}function ep(e){return!!(e.namespace&&ec(e.namespace))}function em(e,t){let n=e.parent,a=n.parent,o=eP(e.symbol);if(H.has(e)||H.set(e,!1),X.has(eu(e),r.Constraint))return void 0===t&&_((0,b.o)({code:"circular-constraint",format:{typeName:e.id.sv},target:e.constraint})),F;let i=o.declaredType;if(void 0===i){a&&a.locals?.has(e.id.sv)&&_((0,b.o)({code:"shadow",format:{name:e.id.sv},target:e}));let t=n.templateParameters.findIndex(t=>t===e);i=o.declaredType=ta({kind:"TemplateParameter",node:e}),e.constraint&&(X.start(eu(e),r.Constraint),i.constraint=eS(e.constraint),X.finish(eu(e),r.Constraint)),e.default&&(i.default=function(e,t,n,r){let a=function e(r){let a=ed(r),o=!1;if(null!==a&&"kind"in a&&"TemplateParameter"===a.kind){for(let e=n;e<t.length;e++)if(a.node.symbol===t[e].symbol)return void _((0,b.o)({code:"invalid-template-default",target:r}));return a}return(0,h.LI)(r,t=>{void 0===e(t)&&(o=!0)}),o?void 0:a}(e)??F;return!("kind"in a&&(0,S.xg)(a))&&r&&function(e,t,n){let[r,a]=W.isTypeAssignableTo(e,t,n);r||Y(a)}(a,r,e),a}(e.default,n.templateParameters,t,i.constraint))}return t?t.getMappedType(i):i}function ef(e,t,n=!0){let r=eV(e,t);return r?function(e,t,n,r=!0){let a=eg(e,t,n,r);return null===a||(0,S.ml)(a)?(_((0,b.o)({code:"value-in-type",target:t})),F):"Indeterminate"===a.entityKind?a.type:a}(r,e,t,n):F}function ey(t,n){let r=(0,p.LA)(e,t);r&&(0,p.BG)(e,n,r)}function eg(t,n,r,a=!0){let o=function(t,n,r,a=!0){let o;if(131072&t.flags)return er(t.declarations[0],r);if(512&t.flags)return _((0,b.o)({code:"invalid-type-ref",messageId:"decorator",target:t})),F;if(2048&t.flags)return _((0,b.o)({code:"invalid-type-ref",messageId:"function",target:t})),F;let i=n.kind===M.a6.TypeReference?n.arguments:[],l=eP(t);if(1048576&t.flags&&238&t.flags){let e=t.declarations[0];if(L(e)){let l=function(e,t,n){var r;let a=eP(e);return a.declaredType?a.declaredType:4194304&e.flags?((0,m.a7)(e.type,"Expected late bound symbol to have type"),e.type):65536&e.flags?et(e,n):"Indeterminate"===(r=ev(e,t,n)).entityKind?r.type:r}(t,e,r),s=function(e,t,n,r){let a=new Map,o=[],i=new Map(n.map(e=>{let t=em(e,void 0);return o.push(t),a.set(e.id.sv,t),[t,{decl:e,checkArgument:null}]})),l=!1;for(let[n,d]of t.map((e,t)=>[e,t])){function s(){return[n,ed(n.argument,r)]}if(n.name){l=!0;let e=a.get(n.name.sv);if(!e){_((0,b.o)({code:"invalid-template-args",messageId:"unknownName",format:{name:n.name.sv},target:n}));continue}if(null!==i.get(e).checkArgument){_((0,b.o)({code:"invalid-template-args",messageId:"specifiedAgain",format:{name:n.name.sv},target:n}));continue}i.get(e).checkArgument=s}else{if(l&&_((0,b.o)({code:"invalid-template-args",messageId:"positionalAfterNamed",target:n})),d>=o.length){_((0,b.o)({code:"invalid-template-args",messageId:"tooMany",target:e}));continue}let t=o[d];i.get(t).checkArgument??=s}}let d=[],u=[];for(let[t,{decl:n,checkArgument:a}]of[...i]){function c(e,t){i.set(e,t),d.push(e),u.push(t)}if(null===a){let a=function(e,t,n){if(void 0!==e.default)return(0,S.Xj)(e.default)&&(0,S.xg)(e.default)||null===e.default?e.default:ed(t.default,n)}(t,n,E(d,u,{node:e,mapper:r}));a?c(t,a):(_((0,b.o)({code:"invalid-template-args",messageId:"missing",format:{name:n.id.sv},target:e})),c(t,t.constraint?.type??z));continue}let[o,l]=a();if(null===l){c(t,z);continue}if(t.constraint){let e=t.constraint.type?.kind==="TemplateParameter"?i.get(t.constraint.type):t.constraint;if((0,S.Xj)(l)&&ei(t.constraint)&&eo(l)!==l){c(t,l);continue}if(t.constraint&&!e6(l,e,o)){let e=t.constraint.type??z;c(t,e);continue}}else if((0,S.xg)(l)){c(t,z);continue}else if((0,S.ml)(l)){_((0,b.o)({code:"value-in-type",messageId:"noTemplateConstraint",target:o})),c(t,z);continue}c(t,l)}return i}(n,i,e.templateParameters,r);o=ek(e,[...s.keys()],[...s.values()],{node:n,mapper:r},l.templateMapper,a)}else{if(i.length>0&&_((0,b.o)({code:"invalid-template-args",messageId:"notTemplate",target:n})),4194304&t.flags)return(0,m.a7)(t.type,"Expected late bound symbol to have type"),t.type;o=l.declaredType?l.declaredType:65536&t.flags?et(t,r):ev(t,e,r)}}else{let e=(0,d.gG)(t);if(i.length>0&&_((0,b.o)({code:"invalid-template-args",messageId:"notTemplate",target:n})),4194304&t.flags)return(0,m.a7)(t.type,"Expected late bound symbol to have type"),t.type;1024&t.flags?o=em(e,r):l.type?o=l.type:l.declaredType?o=l.declaredType:65536&t.flags?o=et(t,r):l.type=o=en(e,r)}let s=(0,d.gG)(t);return(s&&void 0===r&&(0,S.Xj)(o)&&!function e(t){function n(e){return B.has(e)||B.set(e,(e.directives??[]).findIndex(e=>"deprecated"===e.target.sv)>=0),B.get(e)}switch(t.kind){case M.a6.ModelStatement:return n(t);case M.a6.OperationStatement:return n(t)||t.parent.kind===M.a6.InterfaceStatement&&e(t.parent);case M.a6.InterfaceStatement:return n(t);case M.a6.IntersectionExpression:case M.a6.UnionExpression:case M.a6.ModelProperty:case M.a6.OperationSignatureDeclaration:case M.a6.OperationSignatureReference:return e(t.parent);default:return!1}}(n.parent)&&function(t,n,r){if(n){let t=(0,p.LA)(e,n);if(t)return K(e,r,t.message,_)}let a=(0,p.LA)(e,t);a&&K(e,r,a.message,_)}(o,s,n),(0,S.Xj)(o)&&("EnumMember"===o.kind||"UnionVariant"===o.kind)||(0,S.Cm)(o))?eU(o):o}(t,n,r,a);return null!==o&&(0,S.Xj)(o)&&"TemplateParameter"===o.kind&&H.set(o.node,!0),o}function ev(e,t,n){return 2&e.flags?ej(t,n):4&e.flags?e4(t,n):128&e.flags?e5(t,n):32&e.flags?e3(t,n):8&e.flags?eE(t,n):e8(t,n)}function ek(e,t,n,r,a,o=!0){let i=e.kind===M.a6.OperationStatement&&e.parent.kind===M.a6.InterfaceStatement?tn(e):eP(e.symbol);if((0,m.a7)(i,`Unexpected checker error. symbolLinks was not defined for ${M.a6[e.kind]}`),void 0===i.instantiations){let t=en(e);if((0,S.xg)(t))return F;(0,m.a7)(!1,`Unexpected checker error. symbolLinks.instantiations was not defined for ${M.a6[e.kind]}`)}let l=E(t,n,r,a),s=i.instantiations?.get(l.args);return s||(o?function(e,t,n,r){let a=en(t,r);return e.get(r.args)||e.set(r.args,a),"Model"===a.kind&&(a.templateNode=t),a}(i.instantiations,e,0,l):F)}function eb(e,t){let n=(0,s.nQ)(),r=ta({kind:"Union",node:e,options:t,decorators:[],variants:n,expression:!0});for(let e of t){let t=Symbol("indexer-union-variant");n.set(t,ta({kind:"UnionVariant",node:void 0,type:e,name:t,union:r,decorators:[]}))}return r}function eT(e,t){let n=ts(e.symbol),r=eP(n);if(r.declaredType&&void 0===t)return r.declaredType;let a=eI(e);(0,m.a7)(a,`Decorator ${e.id.sv} should have resolved a namespace or found the global namespace.`);let o=e.id.sv;2&e.modifierFlags||_((0,b.o)({code:"decorator-extern",target:e}));let i=n.value;void 0===i&&_((0,b.o)({code:"missing-implementation",target:e}));let l=to({kind:"Decorator",name:`@${o}`,namespace:a,node:e,target:eh(e.target,t,!0),parameters:e.parameters.map(e=>eh(e,t,!0)),implementation:i??(()=>{})});return a.decoratorDeclarations.set(o,l),ee(r,l,t),l}function eh(e,t,n){let r,a=eP(e.symbol);if(a.declaredType)return a.declaredType;e.rest&&e.type&&e.type.kind!==M.a6.ArrayExpression&&(e.type.kind!==M.a6.ValueOfExpression||e.type.target.kind!==M.a6.ArrayExpression)&&_((0,b.o)({code:"rest-parameter-array",target:e.type}));let o={kind:"FunctionParameter",node:e,name:e.id.sv,optional:e.optional,rest:e.rest,implementation:e.symbol.value};if(n){let t=e.type?eS(e.type):{entityKind:"MixedParameterConstraint",type:z};r=to({...o,type:t,mixed:!0,implementation:e.symbol.value})}else r=to({...o,mixed:!1,type:e.type?en(e.type):z,implementation:e.symbol.value});return ee(a,r,t),r}function ex(e,t){return e.kind===M.a6.ValueOfExpression?["value",en(e.target,t)]:["type",en(e,t)]}function eS(e,t){if(e.kind===M.a6.UnionExpression){let n=[],r=[];for(let a of e.options){let[e,o]=ex(a,t);"value"===e?n.push(o):r.push(o)}return{entityKind:"MixedParameterConstraint",node:e,valueType:0===n.length?void 0:1===n.length?n[0]:eb(e,n),type:0===r.length?void 0:1===r.length?r[0]:eb(e,r)}}{let[n,r]=ex(e,t);return{entityKind:"MixedParameterConstraint",node:e,type:"value"===n?void 0:r,valueType:"value"===n?r:void 0}}}function eM(e,t){let n=en(e.elementType,t),r=Z("Array").node,a=en(r.templateParameters[0]);return ek(r,[a],[n],{node:e,mapper:t},void 0)}function ew(e){(0,m.a7)(e.symbol,"Namespace is unbound.",e);let t=ts(e.symbol),n=eP(t);if(!n.type){let r=eI(e),a=e.id.sv,o=to({kind:"Namespace",name:a,namespace:r,node:e,models:new Map,scalars:new Map,operations:new Map,namespaces:new Map,interfaces:new Map,unions:new Map,enums:new Map,decoratorDeclarations:new Map,functionDeclarations:new Map,decorators:[]});for(let e of(n.type=o,t.declarations))e.kind===M.a6.NamespaceStatement&&(o.decorators=o.decorators.concat(e7(o,e,void 0)));ti(o),r?.namespaces.set(a,o)}return n.type}function eI(e){if(e===R.node)return;if(e.kind===M.a6.ModelExpression||e.kind===M.a6.IntersectionExpression){let t=e.parent;for(;void 0!==t;)if(t.kind===M.a6.AliasStatement||t.kind===M.a6.ModelStatement||t.kind===M.a6.ScalarStatement||t.kind===M.a6.OperationStatement||t.kind===M.a6.EnumStatement||t.kind===M.a6.InterfaceStatement||t.kind===M.a6.UnionStatement||t.kind===M.a6.ModelExpression||t.kind===M.a6.IntersectionExpression)return eI(t);else t=t.parent;return}if(e.kind===M.a6.OperationStatement&&e.parent&&e.parent.kind===M.a6.InterfaceStatement)return eI(e.parent);if(!e.symbol.parent||e.symbol.parent.declarations[0].kind===M.a6.TypeSpecScript||e.symbol.parent.declarations[0].kind===M.a6.JsSourceFile)return R;let t=ts(e.symbol.parent),n=eP(t);if(!n.type){let r=t.declarations.find(e=>e.kind===M.a6.NamespaceStatement||e.kind===M.a6.JsNamespaceDeclaration);(0,m.a7)(r,"Can't find namespace declaration node.",e),n.type=ew(r)}return n.type}function eE(e,n,a){let i,l,d,u=e.parent?.kind===M.a6.InterfaceStatement,c=u?tt(e):e.symbol,p=c&&eP(c);if(p&&p.declaredType&&void 0===n)return p.declaredType;void 0===n&&u&&(0,m.a7)(a,"Operation in interface should already have been checked.",e.parent),eL(e,n),L(e)&&void 0!==n&&a&&(n={...n,partial:!0});let f=eI(e),y=e.id.sv,g=[],{resolvedSymbol:v}=t.resolveMetaMemberByName(c,"parameters");if(v?.members){let n=t.getAugmentedSymbolTable(v.members),r=function(e){if(void 0===e.docs)return new Map;let t=new Map;for(let n of e.docs)for(let e of n.tags)e.kind===M.a6.DocParamTag&&t.set(e.paramName.sv,U(e.content));return t}(e);for(let[e,t]of n){let n=r.get(e);n&&o.set(t,n)}}if(e.signature.kind===M.a6.OperationSignatureReference){let a=function(e,n,a){if(!n)return;let o=eu(e);o&&X.start(o,r.BaseType);let i=t.getNodeLinks(n).resolvedSymbol;if(i&&X.has(i,r.BaseType)){void 0===a&&_((0,b.o)({code:"circular-op-signature",format:{typeName:i.name},target:n}));return}let l=en(n,a);if(o&&X.finish(o,r.BaseType),!(0,S.xg)(l))return"Operation"!==l.kind?void _((0,b.o)({code:"is-operation",target:n})):l}(e,e.signature.baseOperation,n);if(a){d=a;let e=td(a.parameters,{properties:(0,s.nQ)()});e.properties=(0,s.nQ)(Array.from(a.parameters.properties.entries()).map(([t,n])=>[t,tc(te(v,n.name),n,{model:e,sourceProperty:n})])),i=ti(e),l=a.returnType,g=[...a.decorators]}else i=ta({kind:"Model",name:"",decorators:[],properties:(0,s.nQ)(),derivedModels:[],sourceModels:[]}),l=$}else i=en(e.signature.parameters,n),l=en(e.signature.returnType,n);let k=to({kind:"Operation",name:y,namespace:f,node:e,parameters:i,returnType:l,decorators:g,sourceOperation:d,interface:a});p&&ee(p,k,n),g.push(...e7(k,e,n)),k.parameters.namespace=f;let T=e.parent;return D(k,n),T.kind===M.a6.InterfaceStatement?eC(T,n)&&eC(e,n)&&ti(k):(eC(e,n)&&ti(k),void 0===n&&f?.operations.set(y,k)),k}function eP(e){return t.getSymbolLinks(e)}function eA(e,t){let n=e.parent,r=eV(n,t,!1);return!r&&(0,h.qq)(n)&&void 0!==n.target&&(r=eV(n.target,t,!1)),r?.declarations.filter(e=>L(e))??[]}function eN(t){let n,r,a=e=>e?.kind===M.a6.ArrayLiteral||e?.kind===M.a6.ObjectLiteral,o=e=>e?.kind===M.a6.ModelExpression||e?.kind===M.a6.TupleExpression,i=e=>a(e)||o(e),l=[],s=(0,h._$)(t,e=>((function(e,t,n){if(e.kind===M.a6.ArrayLiteral||e.kind===M.a6.TupleExpression){let r=e.values.findIndex(e=>e===t);r>=0?n.unshift({tupleIndex:r}):(0,m.a7)(!1,"not expected, can't find child from the parent?")}(e.kind===M.a6.ModelProperty||e.kind===M.a6.ObjectLiteralProperty)&&n.unshift({propertyName:e.id.sv})})(e,n,l),n=e,i(e)&&(e.parent?.kind===M.a6.TemplateParameterDeclaration||e.parent?.kind===M.a6.TemplateArgument||e.parent?.kind===M.a6.DecoratorExpression)||a(e)&&(e.parent?.kind===M.a6.CallExpression||e.parent?.kind===M.a6.ConstStatement)));switch(s?.parent?.kind){case M.a6.TemplateParameterDeclaration:case M.a6.TemplateArgument:r=function(t){let n,r;if(t?.parent?.kind===M.a6.TemplateArgument&&t?.parent?.parent?.kind===M.a6.TypeReference){let e=t.parent,n=t.parent.parent,a=eA(e,void 0),o=n.arguments.findIndex(t=>t===e);a.length>0&&a[0].templateParameters.length>o&&(r=a[0].templateParameters[o])}else t.parent?.kind===M.a6.TemplateParameterDeclaration&&(r=t?.parent);if(r?.kind===M.a6.TemplateParameterDeclaration&&r.constraint)return a(t)&&r.constraint.kind===M.a6.ValueOfExpression?n=e.checker.getTypeForNode(r.constraint.target):o(t)&&r.constraint.kind!==M.a6.ValueOfExpression&&(n=e.checker.getTypeForNode(r.constraint)),n}(s);break;case M.a6.DecoratorExpression:r=function(t){let n,r=t?.parent;if(r?.kind!==M.a6.DecoratorExpression)return;let i=e.checker.resolveRelatedSymbols(r.target.kind===M.a6.MemberExpression?r.target.id:r.target);if(!i||i.length<=0)return;let l=i[0].declarations.find(e=>e.kind===M.a6.DecoratorDeclarationStatement);if(!l)return;let s=e.checker.getTypeForNode(l);(0,m.a7)("Decorator"===s.kind,"Expected type to be a Decorator.");let d=r.arguments.findIndex(e=>e===t);if(d<0||d>=s.parameters.length)return;let u=s.parameters[d];return a(t)?n=u.type.valueType:o(t)?n=u.type.type??u.type.valueType:(0,m.a7)(!1,"not expected node type to get reference model from decorator argument"),n}(s);break;case M.a6.CallExpression:r=function(e){let t=e?.parent;if(t?.kind!==M.a6.CallExpression)return;let n=eX(t,void 0);if(n?.kind!=="ScalarConstructor")return;let r=t.arguments.findIndex(t=>t===e);if(!(r<0)&&!(r>=n.parameters.length))return n.parameters[r].type}(s);break;case M.a6.ConstStatement:r=function(t){let n=t?.parent;if(n&&n.kind===M.a6.ConstStatement&&n.type&&n.value===t)return e.checker.getTypeForNode(n.type)}(s)}return function e(t,n){let r=t;if(r&&"Model"!==r.kind&&"Tuple"!==r.kind&&"Union"!==r.kind)return[];if(0===n.length)switch(r?.kind){case"Model":return[r];case"Union":let a=[];for(let t of r.variants.values())("Model"===t.type.kind||"Tuple"===t.type.kind||"Union"===t.type.kind)&&a.push(...e(t.type,n)??[]);return a;default:return[]}let o=n[0];switch(r?.kind){case"Tuple":if(void 0!==o.tupleIndex&&o.tupleIndex>=0&&o.tupleIndex<r.values.length)return e(r.values[o.tupleIndex],n.slice(1));return[];case"Model":if("Array"===r.name&&void 0!==o.tupleIndex)r=r.templateMapper?.args[0];else{if("Array"===r.name||!o.propertyName)return[];r=r.properties.get(o.propertyName)?.type}return e(r,n.slice(1));case"Union":let i=[];for(let t of r.variants.values())("Model"===t.type.kind||"Tuple"===t.type.kind||"Union"===t.type.kind)&&i.push(...e(t.type,n)??[]);return i;default:return[]}}(r,l)}function eV(n,r,a){let o="boolean"==typeof a?{...C,resolveDecorators:a}:{...C,...a??{}};if(void 0===r&&o.checkTemplateTypes&&I.has(n))return I.get(n);let i=function(n,r,a){if(!(0,h.qq)(n)){if(n.kind===M.a6.TypeReference)return eV(n.target,r,a);if(n.kind===M.a6.Identifier){let o=t.getNodeLinks(n);if(void 0===r&&o.resolutionResult)if(void 0===r&&o.resolutionResult&(M.lS.NotFound|M.lS.Unknown))_((0,b.o)({code:"invalid-ref",messageId:a.resolveDecorators?"decorator":"identifier",format:{id:function e(t){switch(t.kind){case M.a6.MemberExpression:return`${e(t.base)}.${e(t.id)}`;case M.a6.TypeReference:return e(t.target);case M.a6.Identifier:return t.sv}}(n)},target:n,codefixes:"number"===n.sv?[(0,u.o)(n,"float64")]:void 0}));else o.resolutionResult&M.lS.Ambiguous&&function(t,n){let r=n.map(e=>(0,S.eN)(e,{useGlobalPrefixAtTopLevel:!0}));e.reportDiagnostic((0,b.o)({code:"ambiguous-symbol",format:{name:t.sv,duplicateNames:r.join(", ")},target:t}))}(n,o.ambiguousSymbols);let i=o.resolvedSymbol;return i?.symbolSource??i}if(n.kind===M.a6.MemberExpression){let e=eV(n.base,r,{...a,resolveDecorators:!1});if(!e)return;if(128&e.flags){let t=eD(e,r);if(!t)return void _((0,b.o)({code:"invalid-ref",messageId:"node",format:{id:n.id.sv,nodeName:e.declarations[0]?M.a6[e.declarations[0].kind]:"Unknown node"},target:n}));e=t}var o=e,i=n,l=a;let{finalSymbol:s,resolvedSymbol:u}=t.resolveMemberExpressionForSym(o,i,l),c=u??s;if(c)return c;if(256&o.flags)_((0,b.o)({code:"invalid-ref",messageId:"underNamespace",format:{namespace:(0,S.eN)(o),id:i.id.sv},target:i}));else if(512&o.flags)_((0,b.o)({code:"invalid-ref",messageId:"inDecorator",format:{id:i.id.sv},target:i}));else if(2048&o.flags)_((0,b.o)({code:"invalid-ref",messageId:"node",format:{id:i.id.sv,nodeName:"function"},target:i}));else if(118&o.flags)_((0,b.o)({code:"invalid-ref",messageId:"."===i.selector?"member":"metaProperty",format:{kind:function(e){switch(e.kind){case M.a6.ModelStatement:case M.a6.ModelExpression:return"Model";case M.a6.ModelProperty:return"ModelProperty";case M.a6.EnumStatement:return"Enum";case M.a6.InterfaceStatement:return"Interface";case M.a6.UnionStatement:return"Union";default:return"Type"}}((0,d.gG)(o)),id:i.id.sv},target:i}));else{let e=(0,d.gG)(o);_((0,b.o)({code:"invalid-ref",messageId:"node",format:{id:i.id.sv,nodeName:e?M.a6[e.kind]:"Unknown node"},target:i}))}return}(0,m.a7)(!1,`Unknown type reference kind "${M.a6[n.kind]}"`,n)}}(n,r,o);return o.checkTemplateTypes&&I.set(n,i),i}function eD(e,n){let r=(0,d.gG)(e),a=t.getSymbolLinks(e);if(!a.aliasResolutionIsTemplate)return a.aliasedSymbol??t.getNodeLinks(r).resolvedSymbol;let o=en(r,n);if(!(0,S.xg)(o))switch(o.kind){case"Model":case"Interface":case"Union":if((0,S.w7)(o))return eJ(o),o.symbol;default:return ts(o.node.symbol)??e}}function eU(e){let t=a.get(e);if(t)return t;let n={entityKind:"Indeterminate",type:e};return a.set(e,n),n}function eO(e){return to({kind:"StringTemplateSpan",node:e,isInterpolated:!1,type:tl(e)})}function eK(e){for(let t of e.statements)ed(t,void 0)}function eL(e,t){if(void 0===t)for(let t of e.templateParameters)em(t,void 0)}function ej(a,l){let d=eP(a.symbol);if(d.declaredType&&void 0===l)return d.declaredType;eL(a,l);let u=[],c=to({kind:"Model",name:a.id.sv,node:a,properties:(0,s.nQ)(),namespace:eI(a),decorators:u,sourceModels:[],derivedModels:[]});if(ee(d,c,l),a.symbol.members){let e=t.getAugmentedSymbolTable(a.symbol.members),n=function(e){if(void 0===e.docs)return new Map;let t=new Map;for(let n of e.docs)for(let e of n.tags)e.kind===M.a6.DocPropTag&&t.set(e.propName.sv,U(e.content));return t}(a);for(let[t,r]of e){let e=n.get(t);e&&o.set(r,e)}}let p=function(e,n,a){let o;if(!n)return;let i=eu(e);if(X.start(i,r.BaseType),n.kind===M.a6.ModelExpression)return void _((0,b.o)({code:"is-model",messageId:"modelExpression",target:n}));if(n.kind===M.a6.ArrayExpression)o=eM(n,a);else{if(n.kind!==M.a6.TypeReference)return void _((0,b.o)({code:"is-model",target:n}));let e=t.getNodeLinks(n).resolvedSymbol;if(e&&X.has(e,r.BaseType)){void 0===a&&_((0,b.o)({code:"circular-base-type",format:{typeName:e.name},target:e}));return}o=en(n,a)}return(X.finish(i,r.BaseType),"Model"!==o.kind)?void _((0,b.o)({code:"is-model",target:n})):""===o.name?void _((0,b.o)({code:"is-model",messageId:"modelExpression",target:n})):o}(a,a.is,l);if(p&&(c.sourceModel=p,c.sourceModels.push({usage:"is",model:p}),u.push(...p.decorators),p.indexer&&(c.indexer=p.indexer)),p)for(let e of p.properties.values()){let t=tc(te(a.symbol,e.name),e,{sourceProperty:e,model:c});e_(a,t,l),c.properties.set(e.name,t)}p?c.baseModel=p.baseModel:a.extends&&(c.baseModel=function(n,a,o){if(a.kind===M.a6.ModelExpression)return void _((0,b.o)({code:"extend-model",messageId:"modelExpression",target:a}));if(a.kind!==M.a6.TypeReference)return void _((0,b.o)({code:"extend-model",target:a}));let i=eu(n);X.start(i,r.BaseType);let l=t.getNodeLinks(a).resolvedSymbol;if(l&&X.has(l,r.BaseType)){void 0===o&&_((0,b.o)({code:"circular-base-type",format:{typeName:l.name},target:l}));return}let s=en(a,o);return(X.finish(i,r.BaseType),(0,S.xg)(s))?void(0,m.a7)(e.hasError(),"Should already have reported an error.",a):"Model"!==s.kind?void _((0,b.o)({code:"extend-model",target:a})):(""===s.name&&_((0,b.o)({code:"extend-model",messageId:"modelExpression",target:a})),s)}(a,a.extends,l),c.baseModel&&ey(c.baseModel,c)),c.baseModel&&c.baseModel.derivedModels.push(c),void 0===l&&c.namespace?.models.set(c.name,c),eF(a,c.properties,c,l),u.push(...e7(c,a,l)),D(c,l),eC(a,l)&&ti(c);let f=(0,i.CT)(e,c);return"Array"===c.name&&ep(c)?n.Array=c:"Record"===c.name&&ep(c)&&(n.Record=c),f&&(c.indexer=f),eJ(c),eW(c),c}function eC(e,t){return 0===e.templateParameters.length||void 0!==t&&!t.partial&&t.args.every(e=>(0,S.ml)(e)||"Indeterminate"===e.entityKind||"TemplateParameter"!==e.kind)}function eR(e,t,n){let r=function(e){let t=e;for(;t;){if(t.indexer)return t.indexer;t=t.baseModel}}(e);if(void 0!==r)return eB(r,t,n)}function eB(e,t,n){if("integer"===e.key.name)return void Y([(0,b.o)({code:"no-array-properties",target:n})]);let[r,a]=W.isTypeAssignableTo(t.type,e.value,n);r||_((0,b.o)({code:"incompatible-indexer",format:{message:a.map(e=>`  ${e.message}`).join("\n")},target:n.kind===M.a6.ModelProperty?n.value:n}))}function eF(t,n,r,a){let o;for(let i of t.properties)if("id"in i){let e=eY(i,a);e.model=r,eR(r,e,i),eH(n,e)}else{let[l,s]=function(t,n,r,a){let o=en(n,a);if("TemplateParameter"===o.kind||(0,S.xg)(o))return[[],void 0];if("Model"!==o.kind||(0,S.x3)(e,o))return _((0,b.o)({code:"spread-model",target:n}),a),[[],void 0];r===o&&_((0,b.o)({code:"spread-model",messageId:"selfSpread",target:n})),r.sourceModels.push({usage:"spread",model:o});let i=[];for(let e of N(o)){let n=te(t,e.name);i.push(tc(n,e,{sourceProperty:e,model:r}))}return[i,o.indexer]}(t.symbol,i.target,r,a);for(let e of(s&&(o?o.push(s):o=[s]),l))e_(t,e,a),eR(r,e,i),eH(n,e,i)}if(o){let e=1===o.length?o[0].value:function(e){let t=(0,s.nQ)(),n=ta({kind:"Union",node:void 0,options:e,decorators:[],variants:t,expression:!0});for(let r of e){let e=Symbol("indexer-union-variant");t.set(e,ta({kind:"UnionVariant",node:void 0,type:r,name:e,union:n,decorators:[]}))}return n}(o.map(e=>e.value));r.indexer={key:o[0].key,value:e}}}function e$(e,t){return P.set(e,t),e}function eQ(e,t){let n={...e,...t},r=P.get(e);return r&&P.set(n,r),n}function ez(e,t){if(void 0!==e)switch(e.kind){case"Scalar":if((0,m.r$)(J.isTypeAssignableTo(t,e,t)))return e;return;case"Union":let n;for(let r of e.variants.values()){let e=ez(r.type,t);if(e)if(n)return void _((0,b.o)({code:"ambiguous-scalar-type",format:{value:(0,v.Uz)(t),types:[n,e].map(e=>e.name).join(", "),example:n.name},target:t}));else n=e}return n;default:return}}function eG(e,t,n){let r;if(t&&!tm(e,t,n))return null;if("StringTemplate"===e.kind)if(!e.stringValue)return Y((0,y.D)(e)),null;else r=e.stringValue;else r=e.value;let a=ez(t?.type,e);return e$({entityKind:"Value",valueKind:"StringValue",value:r,type:t?t.type:e,scalar:a},e)}function eX(e,t){let n=ef(e.target,t);return"Scalar"===n.kind||"ScalarConstructor"===n.kind?n:(_((0,b.o)({code:"non-callable",format:{type:n.kind},target:e.target})),null)}function eq(e,t,n){if(1!==e.arguments.length)return _((0,b.o)({code:"invalid-primitive-init",target:e.target})),null;let r=e.arguments[0],a=er(r,void 0);return null===a?null:a.valueKind!==n?(_((0,b.o)({code:"invalid-primitive-init",messageId:"invalidArg",format:{actual:a.valueKind,expected:n},target:r})),null):tf(a,t,r)?eQ(a,{scalar:t,type:t}):null}function eH(e,t,n){if(e.has(t.name))return void _((0,b.o)({code:"duplicate-property",format:{propName:t.name},target:n??t}));let r=function(e){(0,m.a7)(e.model,"Parent model must be set before overridden property can be found.");for(let t=e.model.baseModel;t;t=t.baseModel){let n=t.properties.get(e.name);if(n)return n}}(t);if(r){let[e,a]=W.isTypeAssignableTo(t.type,r.type,t),o=(0,v.Uz)(r.type),i=(0,v.Uz)(t.type),l=!1;if(e||(_((0,b.o)({code:"override-property-mismatch",format:{propName:t.name,propType:i,parentType:o},target:n??t})),l=!0),!r.optional&&t.optional&&(_((0,b.o)({code:"override-property-mismatch",messageId:"disallowedOptionalOverride",format:{propName:r.name},target:n??t})),l=!0),l)return}e.set(t.name,t)}function eJ(e){if(!e.symbol)switch(e.kind){case"Model":e.symbol=(0,d.v5)(e.node,e.name,4194306),(0,s.Tk)(e.symbol).type=e;break;case"Interface":e.symbol=(0,d.v5)(e.node,e.name,4194336),(0,S.w7)(e)&&"Foo"===e.name&&eP(e.symbol),(0,s.Tk)(e.symbol).type=e;break;case"Union":if(!e.name)return;e.symbol=(0,d.v5)(e.node,e.name,4194368),(0,s.Tk)(e.symbol).type=e}}function eW(e){(0,m.a7)(e.symbol,"Type must have a symbol to late bind members");let n=e.symbol;(0,m.a7)(n.members,"Container symbol didn't have members at late-bind");let r=t.getAugmentedSymbolTable(n.members);switch(e.kind){case"Model":for(let t of N(e))a(t,1114112);break;case"Scalar":for(let t of e.constructors.values())a(t,1114112);break;case"Enum":for(let t of e.members.values())a(t,1114112);break;case"Interface":for(let t of e.operations.values())a(t,1114120);break;case"Union":for(let t of e.variants.values())a(t,1114112)}function a(e,t){if(!e.node||"string"!=typeof e.name)return;let a=(0,d.v5)(e.node,e.name,4194304|t,n);(0,s.Tk)(a).type=e,(0,m.a7)(n.members,"containerSym.members is undefined"),r.set(e.name,a)}}function e_(e,n,r){if(void 0!==r||((0,m.a7)("string"==typeof n.name,"Cannot link unmapped unions"),void 0===e.symbol))return;let a=te(e.symbol,n.name);if(a){var o;o=t.getSymbolLinks(a),void 0===r&&(o.declaredType=n)}}function eY(e,t){let n=tt(e),a=tn(e);if(a&&a.declaredType&&void 0===t)return a.declaredType;let i=e.id.sv,l=to({kind:"ModelProperty",name:i,node:e,optional:e.optional,type:void 0,decorators:[]});if(X.has(n,r.Type)&&void 0===t)_((0,b.o)({code:"circular-prop",format:{propName:i},target:e})),l.type=F;else{if(X.start(n,r.Type),l.type=en(e.value,t),e.default){let t=function(e,t){if((0,S.xg)(t))return null;let n=er(e,void 0,{kind:"assignment",type:t},{legacyTupleAndModelCast:!0});if(null===n)return null;let[r,a]=W.isValueOfType(n,t,e);return r?{...n,type:t}:(Y(a),null)}(e.default,l.type);null!==t&&(l.defaultValue=t)}a&&ee(a,l,t)}l.decorators=e7(l,e,t);let s=(0,S.hO)(e);if(D(l,t),!s||eC(s,t)){let e=o.get(n);e&&l.decorators.unshift(eZ("self",e)),ti(l)}return X.finish(n,r.Type),l}function eZ(e,t){return{decorator:i.DY,args:[{value:tp(e),jsValue:e},{value:tp(t),jsValue:t}]}}function e0(t,n,r){let a=eV(n.target,void 0,!0);if(!a)return;if(!(512&a.flags))return void _((0,b.o)({code:"invalid-decorator",format:{id:a.name},target:n}));let o=eP(a),i=!1;if(void 0===o.declaredType){let e=a.declarations.find(e=>e.kind===M.a6.DecoratorDeclarationStatement);e&&eT(e,void 0)}o.declaredType&&((0,m.a7)("Decorator"===o.declaredType.kind,`Expected to find a decorator type but got ${o.declaredType.kind}`),!function(e,t,n){let[r]=W.isTypeAssignableTo(e,t.target.type,n);return r||_((0,b.o)({code:"decorator-wrong-target",messageId:"withExpected",format:{decorator:t.name,to:(0,v.Uz)(e),expected:(0,v.He)(t.target.type)},target:n})),r}(t,o.declaredType,n)&&(i=!0));let[l,s]=function(t,n,r){if(void 0===r)return[!1,t.arguments.map(e=>{let t=ed(e,n)??F;return"Indeterminate"===t.entityKind&&(t=t.type),{value:t,jsValue:t,node:e}})];let a=!1,o=r.parameters.filter(e=>!e.optional&&!e.rest).length??0,i=r.parameters[r.parameters.length-1]?.rest?void 0:r.parameters.length;if(t.arguments.length<o||void 0!==i&&t.arguments.length>i)if(t.arguments.length<o&&(a=!0),void 0===i)_((0,b.o)({code:"invalid-argument-count",messageId:"atLeast",format:{actual:t.arguments.length.toString(),expected:o.toString()},target:t}));else{let e=o===i?o.toString():`${o}-${i}`;_((0,b.o)({code:"invalid-argument-count",format:{actual:t.arguments.length.toString(),expected:e},target:t}))}let l=[];function s(e,t){var r,a;let o=el(e,n,{kind:"argument",constraint:t});return null!==o&&!((0,S.Xj)(o)&&(0,S.xg)(o))&&e6(o,t,e)?{value:o,node:e,jsValue:(r=o,void 0!==(a=es({kind:"argument",constraint:t}))&&(0,S.ml)(r)?(0,k.J)(r,a.type):r)}:void 0}for(let[n,o]of r.parameters.entries()){if(o.rest){let r=function(t){let n,r;if(t.valueType)if(!("Model"===t.valueType.kind&&(0,S.x3)(e,t.valueType)))return;else n=t.valueType.indexer.value;if(t.type)if(!("Model"===t.type.kind&&(0,S.x3)(e,t.type)))return;else r=t.type.indexer.value;return{entityKind:"MixedParameterConstraint",type:r,valueType:n}}(o.type);if(r)for(let e=n;e<t.arguments.length;e++){let n=t.arguments[e];if(n){let e=s(n,r);e?l.push(e):a=!0}}break}let r=t.arguments[n];if(r){let e=s(r,o.type);e?l.push(e):a=!0}}return[a,l]}(n,r,o.declaredType);if(!i&&!l)return{definition:o.declaredType,decorator:a.value??((...e)=>{}),node:n,args:s}}function e6(e,t,n){let[r]=W.isTypeAssignableTo(e,t,n);return r||_((0,b.o)({code:"invalid-argument",format:{value:(0,v.He)(e),expected:(0,v.He)(t)},target:n})),r}function e1(e,n,r){let a=t.getAugmentDecoratorsForSym(e),o=[];for(let e of a){let t=e0(n,e,r);t&&o.unshift(t)}return o}function e7(e,n,r){var a;let o=(a=n).symbol&&65536&a.symbol.flags?tt(n)??n.symbol:ts(n.symbol),i=[];for(let a of[...t.getAugmentDecoratorsForSym(o),...n.decorators]){let t=e0(e,a,r);t&&i.unshift(t)}let l=function(e){if(e.node?.docs===void 0)return;let t="";for(let n of e.node.docs)t+=U(n.content);let n=t.trim();return""===n?void 0:n}(e);if(l&&i.unshift(eZ("self",l)),"Operation"===e.kind){let t=function(e){let t={returns:void 0,errors:void 0};if(e.node?.docs===void 0)return t;for(let n of e.node.docs)for(let e of n.tags)e.kind===M.a6.DocReturnsTag&&(t.returns=U(e.content)),e.kind===M.a6.DocErrorsTag&&(t.errors=U(e.content));return t}(e);t.returns&&i.unshift(eZ("returns",t.returns)),t.errors&&i.unshift(eZ("errors",t.errors))}else e.kind;return i}function e4(a,o){let i=eP(a.symbol);if(i.declaredType&&void 0===o)return i.declaredType;eL(a,o);let l=[],s=to({kind:"Scalar",name:a.id.sv,node:a,constructors:new Map,namespace:eI(a),decorators:l,derivedScalars:[]});return ee(i,s,o),a.extends&&(s.baseScalar=function(n,a,o){let i=eu(n);X.start(i,r.BaseType);let l=t.getNodeLinks(a).resolvedSymbol;if(l&&X.has(l,r.BaseType)){void 0===o&&_((0,b.o)({code:"circular-base-type",format:{typeName:l.declarations[0].id.sv},target:l}));return}let s=en(a,o);return(X.finish(i,r.BaseType),(0,S.xg)(s))?void(0,m.a7)(e.hasError(),"Should already have reported an error.",a):"Scalar"!==s.kind?void _((0,b.o)({code:"extend-model",target:a})):s}(a,a.extends,o),s.baseScalar&&(ey(s.baseScalar,s),s.baseScalar.derivedScalars.push(s))),function(e,t,n,r){if(e.baseScalar)for(let a of e.baseScalar.constructors.values()){let o=tc(te(t.symbol,a.name),{...a,scalar:e});e_(t,o,r),n.set(a.name,o)}for(let a of t.members){let t=e2(a,r,e);if(n.has(t.name)){_((0,b.o)({code:"constructor-duplicate",format:{name:t.name.toString()},target:a}));continue}n.set(t.name,t)}}(s,a,s.constructors,o),l.push(...e7(s,a,o)),void 0===o&&s.namespace?.scalars.set(s.name,s),D(s,o),eC(a,o)&&ti(s),ep(s)&&(n[s.name]=s),s}function e2(e,t,n){let r=e.id.sv,a=tn(e);if(a&&a.declaredType&&void 0===t)return a.declaredType;let o=to({kind:"ScalarConstructor",scalar:n,name:r,node:e,parameters:e.parameters.map(e=>eh(e,t,!1))});return D(o,t),eC(e.parent,t)&&ti(o),a&&ee(a,o,t),ti(o)}function e5(e,t){let n=eP(e.symbol);if(n.declaredType&&void 0===t)return n.declaredType;eL(e,t);let a=eu(e);if(X.has(a,r.Type))return void 0===t&&_((0,b.o)({code:"circular-alias-type",format:{typeName:e.id.sv},target:e})),n.declaredType=F,F;X.start(a,r.Type);let o=ed(e.value,t);return null===o?(n.declaredType=F,F):(0,S.ml)(o)?(_((0,b.o)({code:"value-in-type",target:e.value})),n.declaredType=F,F):(ee(n,o,t),X.finish(a,r.Type),o)}function e3(e,t){let n=eP(e.symbol);if(n.declaredType&&void 0===t)return n.declaredType;eL(e,t);let r=to({kind:"Interface",decorators:[],node:e,namespace:eI(e),sourceInterfaces:[],operations:(0,s.nQ)(),name:e.id.sv});ee(n,r,t),r.decorators=e7(r,e,t);let a=function(e,t,n){let r=new Map;for(let a of e.operations){let e=eE(a,t,n);if(r.has(e.name)){_((0,b.o)({code:"interface-duplicate",format:{name:e.name},target:a}));continue}r.set(e.name,e)}return r}(e,t,r);for(let n of e.extends){let o=en(n,t);if("Interface"!==o.kind){_((0,b.o)({code:"extends-interface",target:n}));continue}for(let i of o.operations.values()){r.operations.has(i.name)&&_((0,b.o)({code:"extends-interface-duplicate",format:{name:i.name},target:n}));let o=tc(te(e.symbol,i.name),i,{interface:r});a.has(i.name)||e_(e,o,t),ey(i,o),r.operations.set(o.name,o)}r.sourceInterfaces.push(o)}for(let[e,t]of a)r.operations.set(e,t);return D(r,t),eC(e,t)&&ti(r),void 0===t&&r.namespace?.interfaces.set(r.name,r),eJ(r),eW(r),r}function e8(e,t){let n=eP(e.symbol);if(n.declaredType&&void 0===t)return n.declaredType;eL(e,t);let r=(0,s.nQ)(),a=to({kind:"Union",decorators:[],node:e,namespace:eI(e),name:e.id.sv,variants:r,get options(){return Array.from(this.variants.values()).map(e=>e.type)},expression:!1});return ee(n,a,t),a.decorators=e7(a,e,t),function(e,t,n,r){for(let a of t.options){let t=e9(a,r);if(t.union=e,n.has(t.name)){_((0,b.o)({code:"union-duplicate",format:{name:t.name.toString()},target:a}));continue}n.set(t.name,t)}}(a,e,r,t),D(a,t),eC(e,t)&&ti(a),void 0===t&&a.namespace?.unions.set(a.name,a),eJ(a),eW(a),a}function e9(e,t){let n=tn(e);if(n&&n.declaredType&&void 0===t)return n.declaredType;let r=e.id?e.id.sv:Symbol("name"),a=en(e.value,t),o=to({kind:"UnionVariant",name:r,node:e,decorators:[],type:a,union:void 0});return o.decorators=e7(o,e,t),D(o,t),eC(e.parent,t)&&ti(o),n&&ee(n,o,t),o}function te(e,n){return e?t.getAugmentedSymbolTable(e.members).get(n):void 0}function tt(e){if(!e.id)return;let t=e.id.sv,n=e.parent?.symbol;return n?te(n,t):void 0}function tn(e){let t=tt(e);return t&&(0,d.gG)(t)===e?eP(t):void 0}function tr(e,t,n){let r=e.id.sv,a=tn(e);if(a?.type)return a.type;(0,m.a7)(n,"Enum member should already have been checked.");let o=e.value?e.value.value:void 0,i=to({kind:"EnumMember",enum:n,name:r,node:e,value:o,decorators:[]});return a&&(a.type=i),i.decorators=e7(i,e,t),ti(i)}function ta(e){return to(e),ti(e)}function to(t){return Object.setPrototypeOf(t,V),t.isFinished=!1,t.entityKind="Type",t.node&&function(t,n){let r=!1;for(let a of t.directives??[])if("deprecated"===a.target.sv){let o,i=a.arguments[0];if(void 0===i){_((0,b.o)({code:"invalid-deprecation-argument",messageId:"missing",target:a}));continue}i.kind!==M.a6.StringLiteral?(_((0,b.o)({code:"invalid-deprecation-argument",format:{kind:M.a6[i.kind]},target:a.arguments[0]})),o="<missing message>"):o=i.value,!0===r?_((0,b.o)({code:"duplicate-deprecation",target:t})):(r=!0,(0,p.BG)(e,n,{message:o}))}}(t.node,t),t}function ti(t){return O(e,V,t)}function tl(e){return tp(e.value,e)}function ts(e){return t.getMergedSymbol(e)}function td(e,t){let n;switch(e.kind){case"Model":let r=to({...e,decorators:[...e.decorators],properties:void 0,...t});"properties"in t||(r.properties=(0,s.nQ)(Array.from(e.properties.entries()).map(([e,t])=>[e,tu(t,{model:r})]))),n=r;break;case"Union":let a=to({...e,decorators:[...e.decorators],variants:void 0,get options(){return Array.from(this.variants.values()).map(e=>e.type)},...t});"variants"in t||(a.variants=(0,s.nQ)(Array.from(e.variants.entries()).map(([e,t])=>[e,tu(t,{union:a})]))),n=a;break;case"Interface":let o=to({...e,decorators:[...e.decorators],operations:void 0,...t});"operations"in t||(o.operations=(0,s.nQ)(Array.from(e.operations.entries()).map(([e,t])=>[e,tu(t,{interface:o})]))),n=o;break;case"Enum":let i=to({...e,decorators:[...e.decorators],members:void 0,...t});"members"in t||(i.members=(0,s.nQ)(Array.from(e.members.entries()).map(([e,t])=>[e,tu(t,{enum:i})]))),n=i;break;default:n=to({...e,..."decorators"in e?{decorators:[...e.decorators]}:{},...t})}return n}function tu(e,t={}){let n=td(e,t);return e.isFinished&&(n=ti(n)),(0,m.a7)(n.kind===e.kind,"cloneType must not change type kind"),n}function tc(e,t,n={}){let r=td(t,n);if("decorators"in r){let t=o.get(e);for(let n of(t&&r.decorators.push(eZ("self",t)),e1(e,r,void 0)))r.decorators.push(n)}return t.isFinished&&(r=ti(r)),(0,m.a7)(r.kind===t.kind,"cloneType must not change type kind"),r}function tp(t,n){let r,a;if(e.literalTypes.has(t))return e.literalTypes.get(t);switch(typeof t){case"string":r=to({kind:"String",value:t});break;case"boolean":r=to({kind:"Boolean",value:t});break;case"number":n?((0,m.a7)(n.kind===M.a6.NumericLiteral,"Must pass numeric literal node or undefined when creating a numeric literal type"),a=n.valueAsString):a=String(t),r=to({kind:"Number",value:t,valueAsString:a,numericValue:(0,T.ew)(a)})}return e.literalTypes.set(t,r),r}function tm(e,t,n){let[r,a]=W.isTypeAssignableTo(e,t.type,n);return r||("argument"===t.kind?_((0,b.o)({code:"invalid-argument",format:{value:(0,v.He)(e),expected:(0,v.He)(t.type)},target:n})):Y(a)),r}function tf(e,t,n){let[r,a]=W.isValueOfType(e,t,n);return r||Y(a),r}}function E(e,t,n,r){let a=new Map(r?.map??[]);for(let[n,r]of e.entries())a.set(r,t[n]);return{partial:!1,args:[...r?.args??[],...t],getMappedType:e=>a.get(e)??e,source:n,map:a}}function P(e,t,n){let r,a;if(n&&(t=A(e,t,n)),t.name||((0,m.a7)(!t.baseModel,"Anonymous model with base model."),0===t.properties.size))return t;for(let e of t.properties.values()){let n=function(e){if(!e.sourceProperty)return;let t=new Set;for(let n=e;n;n=n.sourceProperty)n.model?.name&&t.add(n.model);return t}(e);if(!n)return t;if(!r){r=n;continue}for(let e of r)if(!n.has(e)){for(let t=e.baseModel;t;t=t.baseModel)if(n.has(t)){n.add(e);break}}for(let e of r)n.has(e)||r.delete(e)}for(let e of r??[]){if(t.properties.size===V(e)){a=e;break}if(n&&!a&&t.properties.size===V(e,n)){a=e;continue}}return a??t}function A(e,t,n){var r,i;let l=!1;for(let e of N(t))if(!n(e)){l=!0;break}if(!l)return t;let s=a.M.realmForType.get(t),d=s?(0,o.$)(s):o.$,u=d.model.create({name:"",indexer:void 0,properties:{},decorators:[],derivedModels:[],sourceModels:[{usage:"spread",model:t}]});for(let e of N(t))if(n(e)){let t=d.type.clone(e);Object.assign(t,{sourceProperty:e,model:u}),u.properties.set(e.name,t),d.type.finishType(t)}return r=e,i=u,O(r,r.checker.typePrototype,i)}function*N(e){let t=new Set;for(let n=e;n;n=n.baseModel)for(let e of n.properties.values())t.has(e.name)||(t.add(e.name),yield e)}function V(e,t){let n=0;for(let r of N(e))(!t||t(r))&&n++;return n}function D(e,t){t&&((0,m.a7)(!e.templateArguments,"Mapper provided but template arguments already set."),e.templateMapper=t,e.templateArguments=t.args)}function U(e){let t=[];for(let n of e)(0,m.a7)(n.kind===M.a6.DocText,"No other doc content node kinds exist yet. Update this code appropriately when more are added."),t.push(n.text);return t.join("")}function O(e,t,n){if("decorators"in n)for(let t of n.decorators)!function(e,t,n){for(let e of((0,m.a7)("decorators"in n,"Cannot apply decorator to non-decoratable type",n),t.args))if((0,S.Xj)(e.value)&&(0,S.xg)(e.value))return;if(t.definition){let r=(0,p.LA)(e,t.definition);void 0!==r&&K(e,t.node??n,r.message,e.reportDiagnostic)}try{let r=t.args.map(e=>e.jsValue),a=t.decorator,o=function(e,t){return{program:e,decoratorTarget:t.node,getArgumentTarget:e=>t.args[e]?.node,call:(n,r,...a)=>n(function e(t,n){return{program:t,decoratorTarget:n.node,getArgumentTarget:()=>n.node,call:(r,a,...o)=>r(e(t,n),a,...o)}}(e,t),r,...a)}}(e,t);a(o,n,...r)}catch(r){if(e.compilerOptions.designTimeBuild)e.reportDiagnostic((0,b.o)({code:"decorator-fail",format:{decoratorName:t.decorator.name,error:r.stack},target:t.node??n}));else throw r}}(e,t,n);return Object.setPrototypeOf(n,t),n.isFinished=!0,n}function K(e,t,n,r){!0!==e.compilerOptions.ignoreDeprecated&&r((0,b.o)({code:"deprecated",format:{message:n},target:t}))}function L(e){return"templateParameters"in e&&e.templateParameters.length>0}!function(e){e[e.Value=0]="Value",e[e.Type=1]="Type",e[e.BaseType=2]="BaseType",e[e.Constraint=3]="Constraint"}(r||(r={}));class j{#e=new Map;start(e,t){let n=this.#e.get(e);void 0===n&&(n=new Set,this.#e.set(e,n)),n.add(t)}has(e,t){return this.#e.get(e)?.has(t)??!1}finish(e,t){let n=this.#e.get(e);void 0!==n&&(n?.delete(t),0===n.size&&this.#e.delete(e))}}let C={resolveDecorators:!1,checkTemplateTypes:!0}}}]);