"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4765],{69283:(e,t,n)=>{n.d(t,{Dt:()=>P,HF:()=>N,wj:()=>I,zN:()=>A});var r,a=n(41726),o=n(37666),i=n(44004),l=n(34502),s=n(34022),d=n(53576),u=n(106),c=n(62573),p=n(67974),m=n(5904),f=n(87478),y=n(92008),g=n(53217),v=n(82702),k=n(37147),b=n(96028),T=n(71563),h=n(5715),x=n(38845),S=n(7860),M=n(26053);let w=class extends s.$V{};function I(e,t){let n={createdTypes:0,finishedTypes:0},a={},i=new WeakMap,I=new Map,P=new WeakMap,N=new WeakMap,V=t=>{e.reportDiagnostic(t)},R={},B=function(){let e=t.symbols.global,n=tl({kind:"Namespace",name:"",node:t.symbols.global.declarations[0],models:new Map,scalars:new Map,operations:new Map,namespaces:new Map,interfaces:new Map,unions:new Map,enums:new Map,decoratorDeclarations:new Map,functionDeclarations:new Map,decorators:[]});return eA(e).type=n,n.decorators=e4(e,n,void 0),ts(n)}(),F=new Map,$=tl({kind:"Intrinsic",name:"ErrorType"}),Q=tl({kind:"Intrinsic",name:"void"}),z=tl({kind:"Intrinsic",name:"never"}),G=tl({kind:"Intrinsic",name:"unknown"}),X=tl({kind:"Intrinsic",name:"null"}),q=new j,H=t.symbols.global.exports.get("TypeSpec");H&&((0,s.Tk)(H.exports).set("log",{flags:2048,name:"log",value:(t,...n)=>(e.trace("log",n.join(" ")),Q),declarations:[],node:void 0}),(0,s.Tk)(t.symbols.null).type=X,eA(t.symbols.null).type=X);let J=new Map,W={getTypeForNode:er,checkProgram:function(){for(let n of(function(){for(let n of(e.reportDuplicateSymbols(t.symbols.global.exports),e.sourceFiles.values()))for(let t of n.namespaces){let n=tu(t.symbol).exports??t.symbol.exports;e.reportDuplicateSymbols(n)}}(),e.sourceFiles.values()))for(let r of(function(n){let r=new Map;for(let e of n.usings){let n=function(e){let t=r.get(e);if(t)return t;let n=new l.i;return r.set(e,n),n}(tu(e.parent.symbol)),a=t.getNodeLinks(e.name).resolvedSymbol;a&&n.track(a,e)}for(let t of r.values())for(let[n,r]of t.entries())for(let t of r)e.reportDiagnostic((0,b.o)({code:"duplicate-using",format:{usingName:(0,g.q5)(t.name)},target:t}))}(n),n.namespaces))eE(r);for(let t of e.sourceFiles.values())ej(t);(0,f.JN)(e)},checkSourceFile:ej,getLiteralType:td,getGlobalNamespaceType:function(){return B},cloneType:tp,resolveRelatedSymbols:function(e,n){let r,{node:a,kind:o}=(0,h.fe)(e);switch(o){case M.wp.ModelExpressionProperty:case M.wp.ObjectLiteralProperty:return eD(a).map(t=>tn(t.node.symbol,e.sv)).filter(e=>void 0!==e);case M.wp.ModelStatementProperty:case M.wp.Declaration:let i=t.getNodeLinks(e);return void 0===i.resolvedSymbol?void 0:[i.resolvedSymbol];case M.wp.Other:return;case M.wp.Decorator:case M.wp.Function:case M.wp.Using:case M.wp.TypeReference:let l=e,s=o===M.wp.Decorator;e.parent?.kind===M.a6.MemberExpression&&(e.parent.id===e?l=e.parent:s=!1),r=eU(l,n,s);break;case M.wp.TemplateArgument:let d=eV(a,n).flatMap(e=>e.templateParameters).find(t=>t.id.sv===e.sv);d&&(r=tu(d.symbol));break;default:(0,m.a7)(!1,"Unreachable")}if(r)if(r.symbolSource)return[r.symbolSource];else return[r]},resolveCompletions:function(n){let r=new Map,{kind:a,node:o}=(0,h.fe)(n);switch(a){case M.wp.Using:case M.wp.Decorator:case M.wp.Function:case M.wp.TypeReference:case M.wp.ModelExpressionProperty:case M.wp.ModelStatementProperty:case M.wp.ObjectLiteralProperty:break;case M.wp.Other:case M.wp.Declaration:return r;case M.wp.TemplateArgument:for(let e of eV(o,void 0))for(let t of e.templateParameters)l(t.id.sv,t.symbol);return r;default:(0,m.a7)(!1,"Unreachable")}if(a===M.wp.ModelStatementProperty){let t=o.parent,a=e.checker.getTypeForNode(t),i=a.baseModel,s=i?.node;if(!s)return r;for(let e of i.properties.values())if(n.sv===e.name||!a.properties.has(e.name)){let t=tn(s.symbol,e.name);t&&l(e.name,t)}}else if(a===M.wp.ModelExpressionProperty||a===M.wp.ObjectLiteralProperty){let e=eD(o);if(e.length<=0)return r;let t=o.parent;for(let r of e)for(let e of A(r))if(n.sv===e.name||!t.properties.find(t=>(t.kind===M.a6.ModelProperty||t.kind===M.a6.ObjectLiteralProperty)&&t.id.sv===e.name)){let t=tn(r.node.symbol,e.name);t&&l(e.name,t)}}else if(n.parent&&n.parent.kind===M.a6.MemberExpression){let e=t.getNodeLinks(n.parent.base).resolvedSymbol;if(e&&(128&e.flags&&(e=eO(e,void 0)),e))if("::"===n.parent.selector)if(e?.node===void 0&&e?.declarations&&e.declarations.length>0){let t=e?.declarations[0];t.kind===M.a6.OperationStatement&&(l("parameters",t.symbol),l("returnType",t.symbol))}else e?.node?.kind===M.a6.ModelProperty&&l("type",e.node.symbol);else i(e.exports??e.members)}else{if(a===M.wp.TypeReference&&(0,h.Px)(o)&&o.parent?.kind===M.a6.TemplateArgument&&void 0===o.parent.name)for(let e of eV(o.parent,void 0))for(let t of e.templateParameters)l(t.id.sv,t.symbol,{suffix:" = "});let e=n.parent;for(;e&&e.kind!==M.a6.TypeSpecScript;)e.symbol&&e.symbol.exports&&i(tu(e.symbol).exports),"locals"in e&&i(e.locals),e=e.parent;if(e&&e.kind===M.a6.TypeSpecScript){for(let t of e.inScopeNamespaces)i(tu(t.symbol).exports);i(t.symbols.global.exports),i(e.locals)}}return r;function i(e){if(e)for(let[n,r]of e=t.getAugmentedSymbolTable(e))if(16384&r.flags)for(let t of e.duplicates.get(r))8192&t.flags&&l((0,S.eN)(t.symbolSource),t);else l(n,r)}function l(e,t,n={}){t.symbolSource&&(t=t.symbolSource),function(e){switch(a){case M.wp.ModelExpressionProperty:case M.wp.ModelStatementProperty:case M.wp.ObjectLiteralProperty:return!!(65536&e.flags);case M.wp.Decorator:return!!(768&e.flags);case M.wp.Using:return!!(256&e.flags);case M.wp.TypeReference:return!(2560&e.flags);case M.wp.TemplateArgument:return!!(1024&e.flags);default:(0,m.a7)(!1,"We should have bailed up-front on other kinds.")}}(t)&&(e.startsWith("@")&&(e=e.slice(1)),r.has(e)||r.set(e,{...n,sym:t}))}},neverType:z,errorType:$,nullType:X,anyType:G,voidType:Q,typePrototype:R,createType:tl,createAndFinishType:ti,createLiteralType:tf,finishType:ts,isStdType:function(e,t){return("Model"===e.kind||"Scalar"===e.kind)&&void 0!==e.namespace&&!!ep(e.namespace)&&("Scalar"===e.kind?void 0===t||t===e.name:"Array"===t&&e===a.Array||"Record"===t&&e===a.Record||"Model"===e.kind&&(void 0===t||t===e.name))},getStdType:ee,resolveTypeReference:function(e){let t=V,n=[];V=e=>n.push(e);let r=ey(e,void 0,!1);return V=t,[r===$?void 0:r,n]},resolveTypeOrValueReference:function(e){let t=V,n=[];V=e=>n.push(e);let r=eg(e,void 0,!1);return V=t,[r===$?void 0:r,n]},getValueForNode:ea,getTypeOrValueForNode:es,getValueExactType:function(e){return N.get(e)},getTemplateParameterUsageMap:function(){return J},isTypeAssignableTo:void 0,stats:n},_=(0,x.i)(e,W);return W.isTypeAssignableTo=_.isTypeAssignableTo,W;function Y(e,t){V(void 0===t||"object"!=typeof e.target?e:{...e,target:{node:e.target,templateMapper:t}})}function Z(e){e.forEach(e=>Y(e))}function ee(e){let t=a[e];if(void 0!==t)return t;let n=H?.exports?.get(e);(0,m.a7)(n,`Unexpected missing symbol to std type "${e}"`),2&n.flags?eR(n.declarations[0],void 0):e5(n.declarations[0],void 0);let r=a[e];return(0,m.a7)(r,`TypeSpec std type "${e}" should have been initalized before using array syntax.`),r}function et(e,t,n){void 0===n?(e.declaredType=t,e.instantiations=new w):e.instantiations&&e.instantiations.set(n.args,t)}function en(e,t){let n=eA(e),r=er((0,d.gG)(e.parent),t),a=n.declaredType??n.type;return a||function(e,t,n){switch(e.kind){case M.a6.ModelProperty:return e0(e,t);case M.a6.EnumMember:return to(e,t,n);case M.a6.OperationStatement:return eN(e,t,n);case M.a6.UnionVariant:return tt(e,t);case M.a6.ScalarConstructor:return e3(e,t,n)}}((0,d.gG)(e),t,r)}function er(e,t){let n=eu(e,t);return null===n?$:"Indeterminate"===n.entityKind?n.type:(0,S.ml)(n)?(Y((0,b.o)({code:"value-in-type",target:e})),$):("TemplateParameter"===n.kind&&n.constraint?.valueType&&Y((0,b.o)({code:"value-in-type",messageId:"referenceTemplate",target:e})),n)}function ea(e,t,n){var r,a;let o,i=eu(e,t,n);return null===i||null===(o="Indeterminate"===i.entityKind?eo(i.type,n,e):i)?null:(0,S.ml)(o)?n?function(e,t){switch(e.valueKind){case"BooleanValue":case"StringValue":case"NumericValue":if(void 0===e.scalar){let n=eX(t,e.type);return eG(e,{scalar:n})}return e;case"ArrayValue":case"ObjectValue":case"EnumValue":case"NullValue":case"ScalarValue":return e}}(o,n.type):o:"TemplateParameter"===o.kind&&o.constraint?.valueType&&void 0===o.constraint.type&&void 0===t?ez({entityKind:"Value",valueKind:"TemplateValue",type:o.constraint.valueType},o.constraint.valueType):(r=e,"Model"===(a=o).kind&&""===a.name&&r.kind===M.a6.ModelExpression?Y((0,b.o)({code:"expect-value",messageId:"model",format:{name:(0,v.Uz)(a)},codefixes:[(0,c.l)(r)],target:r})):"Tuple"===a.kind&&r.kind===M.a6.TupleExpression?Y((0,b.o)({code:"expect-value",messageId:"tuple",format:{name:(0,v.Uz)(a)},codefixes:[(0,c.s)(r)],target:r})):Y((0,b.o)({code:"expect-value",format:{name:(0,v.Uz)(a)},target:r})),null)}function eo(e,t,n){switch(e.kind){case"String":case"StringTemplate":return eq(e,t,n);case"Number":var r,a,o,i,l,s,d=e,u=t,c=n;if(u&&!ty(d,u,c))return null;let p=eX(u?.type,d);return ez({entityKind:"Value",valueKind:"NumericValue",value:(0,T.ew)(d.valueAsString),type:u?u.type:d,scalar:p},d);case"Boolean":var m=e,f=t,y=n;if(f&&!ty(m,f,y))return null;let g=eX(f?.type,m);return ez({entityKind:"Value",valueKind:"BooleanValue",value:m.value,type:f?f.type:m,scalar:g},m);case"EnumMember":return r=e,a=t,o=n,a&&!ty(r,a,o)?null:ez({entityKind:"Value",valueKind:"EnumValue",type:a?a.type:r,value:r},r);case"UnionVariant":return eo(e.type,t,n);case"Intrinsic":if("null"===e.name){return i=e,l=t,s=n,l&&!ty(i,l,s)?null:ez({entityKind:"Value",valueKind:"NullValue",type:l?l.type:i,value:null},i)}return e;default:return e}}function ei(e){var t,n;switch(e.kind){case"Tuple":return t=e,t.node?.kind!==M.a6.TupleExpression?t:(Y((0,b.o)({code:"expect-value",codefixes:[(0,c.s)(t.node)],messageId:"tuple",target:t.node})),null);case"Model":return n=e,n.node?.kind!==M.a6.ModelExpression?n:(Y((0,b.o)({code:"expect-value",codefixes:[(0,c.l)(n.node)],messageId:"modelExpression",target:n.node})),null);default:return e}}function el(e){return!!(e?.valueType&&!e.type)}function es(e,t,n){let r=ed(n),a=eu(e,t,r);if(null===a)return a;if((0,S.Xj)(a))if(el(n?.constraint))return ei(a);else return a;if((0,S.ml)(a))return a;if((0,m.a7)("Indeterminate"===a.entityKind,"Expected indeterminate entity"),r){let t=[],n=V;V=e=>t.push(e);let o=eo(a.type,r,e);if(V=n,o)return Z(t),o}return a.type}function ed(e){return e?.constraint.valueType?{kind:e.kind,type:e.constraint.valueType}:void 0}function eu(n,a,o){switch(n.kind){case M.a6.ModelExpression:case M.a6.ModelStatement:return i=n,l=a,i.kind===M.a6.ModelStatement?eR(i,l):function(e,t){let n=eA(e.symbol);if(n.declaredType&&void 0===t)return n.declaredType;let r=(0,s.nQ)(),a=tl({kind:"Model",name:"",node:e,properties:r,indexer:void 0,namespace:eP(e),decorators:[],derivedModels:[],sourceModels:[]});return et(n,a,t),D(a,t),eQ(e,r,a,t),ts(a)}(i,l);case M.a6.ModelProperty:return e0(n,a);case M.a6.ScalarStatement:return e5(n,a);case M.a6.AliasStatement:return e8(n,a);case M.a6.EnumStatement:var i,l,u,c,p,f,y,g=n,k=a;let T=eA(g.symbol);if(!T.type){let e=T.type=tl({kind:"Enum",name:g.id.sv,node:g,members:(0,s.nQ)(),decorators:[]}),t=new Set;for(let n of g.members)if(n.kind===M.a6.EnumMember){let r=to(n,k,e);if(t.has(r.name)){Y((0,b.o)({code:"enum-member-duplicate",format:{name:r.name},target:g}));continue}t.add(r.name),e.members.set(r.name,r)}else for(let r of function(e,t,n,r,a){let o=[],i=er(n,r);if(!(0,S.xg)(i)){if("Enum"!==i.kind)return Y((0,b.o)({code:"spread-enum",target:n})),o;for(let r of i.members.values())if(a.has(r.name))Y((0,b.o)({code:"enum-member-duplicate",format:{name:r.name},target:n}));else{a.add(r.name);let n=tm(tn(e,r.name),r,{enum:t,sourceMember:r});n&&o.push(n)}}return o}(g.symbol,e,n.target,k,t))eZ(g,r,k),e.members.set(r.name,r);e.namespace=eP(g),e.namespace?.enums.set(e.name,e),e.decorators=e2(e,g,k),D(e,k),ts(e)}return T.type;case M.a6.EnumMember:return to(n,a);case M.a6.InterfaceStatement:return e9(n,a);case M.a6.UnionStatement:return te(n,a);case M.a6.UnionVariant:return tt(n,a);case M.a6.NamespaceStatement:case M.a6.JsNamespaceDeclaration:return function e(t){let n=eA(tu(t.symbol)).type;if(n||(n=eE(t)),t.kind===M.a6.NamespaceStatement){if((0,s.cy)(t.statements))t.statements.forEach(e=>eu(e));else if(t.statements){let r=e(t.statements);n.namespaces.set(r.name,r)}}return n}(n);case M.a6.OperationStatement:return eN(n,a);case M.a6.NumericLiteral:case M.a6.BooleanLiteral:case M.a6.StringLiteral:return eK(td(n));case M.a6.TupleExpression:return u=n,c=a,ti({kind:"Tuple",node:u,values:u.values.map(e=>er(e,c))});case M.a6.StringTemplateExpression:return function(e,t){let n=!1,r=!1,a=e.spans.map(e=>[e,eu(e.expression,t)]);for(let[e,t]of a)null!==t&&((0,S.ml)(t)?r=!0:"kind"in t&&"TemplateParameter"===t.kind&&t.constraint?(t.constraint.valueType&&(r=!0),t.constraint.type&&(n=!0)):n=!0);if(n&&r)return Y((0,b.o)({code:"mixed-string-template",target:e})),null;if(r){let t=e.head.value;for(let[e,n]of a)null===n||"kind"in n&&"TemplateParameter"===n.kind||((0,m.a7)(null!==n&&(0,S.ml)(n),"Expected value."),t+=function(e){switch(e.valueKind){case"StringValue":case"NumericValue":case"BooleanValue":return e.value.toString();default:return Y((0,b.o)({code:"non-literal-string-template",target:e})),`[${e.valueKind}]`}}(n)),t+=e.literal.value;return eq(tf(t),void 0,e)}{let t=!1,n=e.head.value,r=[eL(e.head)];for(let[e,i]of a){var o;(0,m.a7)(null!==i&&!(0,S.ml)(i),"Expected type.");let a="Indeterminate"===i.entityKind?i.type:i,l=(o=e.expression,tl({kind:"StringTemplateSpan",node:o,isInterpolated:!0,type:a}));r.push(l);let s=function(e){switch(e.kind){case"String":case"Number":case"Boolean":return String(e.value);case"StringTemplate":if(void 0!==e.stringValue)return e.stringValue;return;default:return}}(a);void 0!==s?n+=s:t=!0,r.push(eL(e.literal)),n+=e.literal.value}return eK(tl({kind:"StringTemplate",node:e,spans:r,stringValue:t?void 0:n}))}}(n,a);case M.a6.ArrayExpression:return eI(n,a);case M.a6.UnionExpression:var h=n,x=a;let w=ti({kind:"Union",node:h,get options(){return Array.from(this.variants.values()).map(e=>e.type)},expression:!0,variants:(0,s.nQ)(),decorators:[]});for(let e of h.options){let t=er(e,x);if(t!==z)if("Union"===t.kind&&t.expression)for(let[e,n]of t.variants)w.variants.set(e,n);else{let e=tl({kind:"UnionVariant",type:t,name:Symbol("name"),decorators:[],node:void 0,union:w});w.variants.set(e.name,e)}}return D(w,x),w;case M.a6.IntersectionExpression:var I=n,E=a;let P=eA(I.symbol);if(P.declaredType&&void 0===E)return P.declaredType;let N=I.options.map(e=>[e,er(e,E)]),V=function e(t,n,r,a){let o=(0,s.nQ)(),i=tl({kind:"Model",node:n,name:"",namespace:eP(n),properties:o,decorators:[],derivedModels:[],sourceModels:[]}),l=[],d=r.filter(e=>{let[t,n]=e;return"TemplateParameter"!==n.kind&&("Model"===n.kind||(Y((0,b.o)({code:"intersect-non-model",target:t})),!1))});for(let[e,t]of d)t.indexer&&("integer"===t.indexer.key.name?Y((0,b.o)({code:"intersect-invalid-index",messageId:"array",target:e})):l.push(t.indexer));for(let[e,r]of d)for(let e of(i.sourceModels.push({usage:"intersection",model:r}),A(r))){if(o.has(e.name)){Y((0,b.o)({code:"intersect-duplicate-property",format:{propName:e.name},target:n}));continue}let s=t&&tn(t,e.name),d={sourceProperty:e,model:i},u=s?tm(s,e,d):tp(e,d);for(let t of(o.set(e.name,u),eZ(n,u,a),l.filter(e=>e!==r.indexer)))e$(t,e,n)}return 1===l.length?i.indexer=l[0]:l.length>1&&(i.indexer={key:l[0].key,value:e(void 0,n,l.map(e=>[e.value.node,e.value]),a)}),D(i,a),ts(i)}(I.symbol,I,N,E);return et(P,V,E),V;case M.a6.DecoratorDeclarationStatement:return ex(n,a);case M.a6.FunctionDeclarationStatement:return p=n,Y((0,b.o)({code:"function-unsupported",target:p})),$;case M.a6.TypeReference:return eg(n,a);case M.a6.TemplateArgument:return f=n,y=a,eu(f.argument,y);case M.a6.TemplateParameterDeclaration:return ef(n,a);case M.a6.VoidKeyword:return Q;case M.a6.NeverKeyword:return z;case M.a6.UnknownKeyword:return G;case M.a6.ObjectLiteral:var U=n,O=a,K=o;let L=function(e,t){let n=new Map,r=!1;for(let a of e.properties)if("id"in a){let e=ea(a.value,t);null===e?r=!0:n.set(a.id.sv,{name:a.id.sv,value:e,node:a})}else{let e=function(e,t){let n=ea(e,t);return null===n?null:"ObjectValue"!==n.valueKind?(Y((0,b.o)({code:"spread-object",target:e})),null):n}(a.target,t);if(e)for(let[t,r]of e.properties)n.set(t,{...r})}return r?null:n}(U,O);if(null===L)return null;let j=function(e,t){let n=tl({kind:"Model",name:"",node:e,properties:(0,s.nQ)(),decorators:[],derivedModels:[],sourceModels:[]});for(let e of t.values()){var r,a;n.properties.set(e.name,(r=e,a=n,ti({kind:"ModelProperty",node:r.node,model:a,optional:!1,name:r.name,type:r.value.type,decorators:[]})))}return ts(n)}(U,L);return K&&!ty(j,K,U)?null:ez({entityKind:"Value",valueKind:"ObjectValue",node:U,properties:L,type:K?K.type:j},j);case M.a6.ArrayLiteral:return function(e,t,n){let r=!1,a=e.values.map(e=>{let n=ea(e,t);return null===n&&(r=!0),n});if(r)return null;let o=ti({kind:"Tuple",node:e,values:a.map(e=>e.type)});return n&&!ty(o,n,e)?null:ez({entityKind:"Value",valueKind:"ArrayValue",node:e,values:a,type:n?n.type:o},o)}(n,a,o);case M.a6.ConstStatement:var C=n;let R=eA(C.symbol);if(void 0!==R.value)return R.value;let B=C.type?er(C.type,void 0):void 0;if(q.has(C.symbol,r.Value))return Y((0,b.o)({code:"circular-const",format:{name:C.id.sv},target:C})),null;q.start(C.symbol,r.Value);let F=ea(C.value,void 0,B&&{kind:"assignment",type:B});return(q.finish(C.symbol,r.Value),null===F||B&&!tg(F,B,C.id))?R.value=null:R.value=B?eG(F,{type:B}):eG(F),R.value;case M.a6.CallExpression:var X=n,H=a;let J=eH(X,H);return null===J?null:"ScalarConstructor"===J.kind?function(e,t,n){let r=!1,a=n.parameters.filter(e=>!e.optional&&!e.rest).length??0,o=n.parameters[n.parameters.length-1]?.rest?void 0:n.parameters.length;if(e.arguments.length<a||void 0!==o&&e.arguments.length>o)if(e.arguments.length<a&&(r=!0),void 0===o)Y((0,b.o)({code:"invalid-argument-count",messageId:"atLeast",format:{actual:e.arguments.length.toString(),expected:a.toString()},target:e}));else{let t=a===o?a.toString():`${a}-${o}`;Y((0,b.o)({code:"invalid-argument-count",format:{actual:e.arguments.length.toString(),expected:t},target:e}))}let i=[];for(let[a,o]of n.parameters.entries()){if(o.rest){var l;let n="Model"===(l=o.type).kind?l.indexer?.value:void 0;if(n)for(let o=a;o<e.arguments.length;o++){let a=e.arguments[o];if(a){let e=ea(a,t,{kind:"argument",type:n});if(null===e){r=!0;continue}tg(e,n,a)?i.push(e):r=!0}}break}let n=e.arguments[a];if(n){let e=ea(n,t,{kind:"argument",type:o.type});if(null===e){r=!0;continue}tg(e,o.type,n)?i.push(e):r=!0}}return r?null:{entityKind:"Value",valueKind:"ScalarValue",value:{name:n.name,args:i},scalar:n.scalar,type:n.scalar}}(X,H,J):_.areScalarsRelated(J,ee("string"))?eJ(X,J,"StringValue"):_.areScalarsRelated(J,ee("numeric"))?eJ(X,J,"NumericValue"):_.areScalarsRelated(J,ee("boolean"))?eJ(X,J,"BooleanValue"):(Y((0,b.o)({code:"named-init-required",format:{typeKind:J.kind},target:X.target})),null);case M.a6.TypeOfExpression:var W=n,Z=a;let en=eu(W.target,Z,void 0);if(null===en)return $;if("Indeterminate"===en.entityKind)return en.type;if((0,S.Xj)(en)){if("TemplateParameter"===en.kind){if(void 0===en.constraint||void 0!==en.constraint.type)return Y((0,b.o)({code:"expect-value",messageId:"templateConstraint",format:{name:(0,v.Uz)(en)},target:W.target})),$;else if(en.constraint.valueType)return en.constraint.valueType}return Y((0,b.o)({code:"expect-value",format:{name:(0,v.Uz)(en)},target:W.target})),en}return en.type;case M.a6.AugmentDecoratorStatement:var eo=n;eU(eo.targetType,void 0);let ei=t.getNodeLinks(eo.targetType);if(ei.isTemplateInstantiation)e.reportDiagnostic((0,b.o)({code:"augment-decorator-target",messageId:"noInstance",target:eo.targetType}));else if(ei.finalSymbol?.flags&&1048576&~ei.finalSymbol.flags&&65536&~ei.finalSymbol.flags)e.reportDiagnostic((0,b.o)({code:"augment-decorator-target",messageId:2&ei.finalSymbol.flags?"noModelExpression":64&ei.finalSymbol.flags?"noUnionExpression":"default",target:eo.targetType}));else if(ei.finalSymbol?.flags&&128&ei.finalSymbol.flags){let t=(0,d.gG)(ei.finalSymbol);e.reportDiagnostic((0,b.o)({code:"augment-decorator-target",messageId:t.value.kind===M.a6.UnionExpression?"noUnionExpression":"default",target:eo.targetType}))}return $;case M.a6.UsingStatement:var el=n;let es=eU(el.name,void 0);return es&&256&~es.flags&&Y((0,b.o)({code:"using-invalid-ref",target:el.name})),$;default:return $}}function ec(e){return e.kind===M.a6.OperationStatement&&e.parent?.kind===M.a6.InterfaceStatement?tr(e):e.symbol}function ep(e){return"TypeSpec"===e.name&&e.namespace===B}function em(e){return!!(e.namespace&&ep(e.namespace))}function ef(e,t){let n=e.parent,a=n.parent,o=eA(e.symbol);if(J.has(e)||J.set(e,!1),q.has(ec(e),r.Constraint))return void 0===t&&Y((0,b.o)({code:"circular-constraint",format:{typeName:e.id.sv},target:e.constraint})),$;let i=o.declaredType;if(void 0===i){a&&a.locals?.has(e.id.sv)&&Y((0,b.o)({code:"shadow",format:{name:e.id.sv},target:e}));let t=n.templateParameters.findIndex(t=>t===e);i=o.declaredType=ti({kind:"TemplateParameter",node:e}),e.constraint&&(q.start(ec(e),r.Constraint),i.constraint=ew(e.constraint),q.finish(ec(e),r.Constraint)),e.default&&(i.default=function(e,t,n,r){let a=function e(r){let a=eu(r),o=!1;if(null!==a&&"kind"in a&&"TemplateParameter"===a.kind){for(let e=n;e<t.length;e++)if(a.node?.symbol===t[e].symbol)return void Y((0,b.o)({code:"invalid-template-default",target:r}));return a}return(0,h.LI)(r,t=>{void 0===e(t)&&(o=!0)}),o?void 0:a}(e)??$;return!("kind"in a&&(0,S.xg)(a))&&r&&function(e,t,n){let[r,a]=_.isTypeAssignableTo(e,t,n);r||Z(a)}(a,r,e),a}(e.default,n.templateParameters,t,i.constraint))}return t?t.getMappedType(i):i}function ey(e,t,n=!0){let r=eU(e,t);return r?function(e,t,n,r=!0){let a=ek(e,t,n,r);return null===a||(0,S.ml)(a)?(Y((0,b.o)({code:"value-in-type",target:t})),$):"Indeterminate"===a.entityKind?a.type:a}(r,e,t,n):$}function eg(e,t,n=!0){let r=eU(e,t);return r?ek(r,e,t,n)??$:$}function ev(t,n){let r=(0,p.LA)(e,t);r&&(0,p.BG)(e,n,r)}function ek(t,n,r,a=!0){let o=function(t,n,r,a=!0){let o;if(131072&t.flags)return ea(t.declarations[0],r);if(512&t.flags)return Y((0,b.o)({code:"invalid-type-ref",messageId:"decorator",target:t})),$;if(2048&t.flags)return Y((0,b.o)({code:"invalid-type-ref",messageId:"function",target:t})),$;let i=n.kind===M.a6.TypeReference?n.arguments:[],l=eA(t);if(1048576&t.flags&&238&t.flags){let e=t.declarations[0];if(L(e)){let l=function(e,t,n){var r;let a=eA(e);return a.declaredType?a.declaredType:4194304&e.flags?((0,m.a7)(e.type,"Expected late bound symbol to have type"),e.type):65536&e.flags?en(e,n):"Indeterminate"===(r=eb(e,t,n)).entityKind?r.type:r}(t,e,r),s=function(e,t,n,r,a){let o=new Map,i=[],l=new Map(n.map(e=>{let t=ef(e,void 0);return i.push(t),o.set(e.id.sv,t),[t,{decl:e,checkArgument:null}]})),s=!1;for(let[n,a]of t.map((e,t)=>[e,t])){function d(){return[n,eu(n.argument,r)]}if(n.name){s=!0;let e=o.get(n.name.sv);if(!e){Y((0,b.o)({code:"invalid-template-args",messageId:"unknownName",format:{name:n.name.sv},target:n}));continue}if(null!==l.get(e).checkArgument){Y((0,b.o)({code:"invalid-template-args",messageId:"specifiedAgain",format:{name:n.name.sv},target:n}));continue}l.get(e).checkArgument=d}else{if(s&&Y((0,b.o)({code:"invalid-template-args",messageId:"positionalAfterNamed",target:n})),a>=i.length){Y((0,b.o)({code:"invalid-template-args",messageId:"tooMany",target:e}));continue}let t=i[a];l.get(t).checkArgument??=d}}let u=[],c=[];for(let[t,{decl:n,checkArgument:o}]of[...l]){function p(e,t){l.set(e,t),u.push(e),c.push(t)}if(null===o){let o=function(e,t,n){if(void 0!==e.default)return(0,S.Xj)(e.default)&&(0,S.xg)(e.default)||null===e.default?e.default:eu(t.default,n)}(t,n,E(u,c,{node:e,mapper:r},a));o?p(t,o):(Y((0,b.o)({code:"invalid-template-args",messageId:"missing",format:{name:n.id.sv},target:e})),p(t,t.constraint?.type??G));continue}let[i,s]=o();if(null===s){p(t,G);continue}if(t.constraint){let e=t.constraint.type?.kind==="TemplateParameter"?l.get(t.constraint.type):t.constraint;if((0,S.Xj)(s)&&el(t.constraint)&&ei(s)!==s){p(t,s);continue}if(t.constraint&&!e7(s,e,i)){let e=t.constraint.type??G;p(t,e);continue}}else if((0,S.xg)(s)){p(t,G);continue}else if((0,S.ml)(s)){Y((0,b.o)({code:"value-in-type",messageId:"noTemplateConstraint",target:i})),p(t,G);continue}p(t,s)}return l}(n,i,e.templateParameters,r,l.templateMapper);o=eT(e,[...s.keys()],[...s.values()],{node:n,mapper:r},l.templateMapper,a)}else{if(i.length>0&&Y((0,b.o)({code:"invalid-template-args",messageId:"notTemplate",target:n})),4194304&t.flags)return(0,m.a7)(t.type,"Expected late bound symbol to have type"),t.type;o=l.declaredType?l.declaredType:65536&t.flags?en(t,r):eb(t,e,r)}}else{let e=(0,d.gG)(t);if(i.length>0&&Y((0,b.o)({code:"invalid-template-args",messageId:"notTemplate",target:n})),4194304&t.flags)return(0,m.a7)(t.type,"Expected late bound symbol to have type"),t.type;1024&t.flags?o=ef(e,r):l.type?o=l.type:l.declaredType?o=l.declaredType:65536&t.flags?o=en(t,r):l.type=o=er(e,r)}let s=(0,d.gG)(t);return(s&&void 0===r&&(0,S.Xj)(o)&&!function e(t){function n(e){return F.has(e)||F.set(e,(e.directives??[]).findIndex(e=>"deprecated"===e.target.sv)>=0),F.get(e)}switch(t.kind){case M.a6.ModelStatement:return n(t);case M.a6.OperationStatement:return n(t)||t.parent.kind===M.a6.InterfaceStatement&&e(t.parent);case M.a6.InterfaceStatement:return n(t);case M.a6.IntersectionExpression:case M.a6.UnionExpression:case M.a6.ModelProperty:case M.a6.OperationSignatureDeclaration:case M.a6.OperationSignatureReference:return e(t.parent);default:return!1}}(n.parent)&&function(t,n,r){if(n){let t=(0,p.LA)(e,n);if(t)return K(e,r,t.message,Y)}let a=(0,p.LA)(e,t);a&&K(e,r,a.message,Y)}(o,s,n),(0,S.Xj)(o)&&("EnumMember"===o.kind||"UnionVariant"===o.kind)||(0,S.Cm)(o))?eK(o):o}(t,n,r,a);return null!==o&&(0,S.Xj)(o)&&"TemplateParameter"===o.kind&&J.set(o.node,!0),o}function eb(e,t,n){return 2&e.flags?eR(t,n):4&e.flags?e5(t,n):128&e.flags?e8(t,n):32&e.flags?e9(t,n):8&e.flags?eN(t,n):te(t,n)}function eT(e,t,n,r,a,o=!0){let i=e.kind===M.a6.OperationStatement&&e.parent.kind===M.a6.InterfaceStatement?ta(e):eA(e.symbol);if((0,m.a7)(i,`Unexpected checker error. symbolLinks was not defined for ${M.a6[e.kind]}`),void 0===i.instantiations){let t=er(e);if((0,S.xg)(t))return $;(0,m.a7)(!1,`Unexpected checker error. symbolLinks.instantiations was not defined for ${M.a6[e.kind]}`)}let l=E(t,n,r,a),s=i.instantiations?.get(l.args);return s||(o?function(e,t,n,r){let a=er(t,r);return e.get(r.args)||e.set(r.args,a),"Model"===a.kind&&(a.templateNode=t),a}(i.instantiations,e,0,l):$)}function eh(e,t){let n=(0,s.nQ)(),r=ti({kind:"Union",node:e,options:t,decorators:[],variants:n,expression:!0});for(let e of t){let t=Symbol("indexer-union-variant");n.set(t,ti({kind:"UnionVariant",node:void 0,type:e,name:t,union:r,decorators:[]}))}return r}function ex(e,t){let n=tu(e.symbol),r=eA(n);if(r.declaredType&&void 0===t)return r.declaredType;let a=eP(e);(0,m.a7)(a,`Decorator ${e.id.sv} should have resolved a namespace or found the global namespace.`);let o=e.id.sv;2&e.modifierFlags||Y((0,b.o)({code:"decorator-extern",target:e}));let i=n.value;void 0===i&&Y((0,b.o)({code:"missing-implementation",target:e}));let l=tl({kind:"Decorator",name:`@${o}`,namespace:a,node:e,target:eS(e.target,t,!0),parameters:e.parameters.map(e=>eS(e,t,!0)),implementation:i??(()=>{})});return a.decoratorDeclarations.set(o,l),et(r,l,t),l}function eS(e,t,n){let r,a=eA(e.symbol);if(a.declaredType)return a.declaredType;e.rest&&e.type&&e.type.kind!==M.a6.ArrayExpression&&(e.type.kind!==M.a6.ValueOfExpression||e.type.target.kind!==M.a6.ArrayExpression)&&Y((0,b.o)({code:"rest-parameter-array",target:e.type}));let o={kind:"FunctionParameter",node:e,name:e.id.sv,optional:e.optional,rest:e.rest,implementation:e.symbol.value};if(n){let t=e.type?ew(e.type):{entityKind:"MixedParameterConstraint",type:G};r=tl({...o,type:t,mixed:!0,implementation:e.symbol.value})}else r=tl({...o,mixed:!1,type:e.type?er(e.type):G,implementation:e.symbol.value});return et(a,r,t),r}function eM(e,t){return e.kind===M.a6.ValueOfExpression?["value",er(e.target,t)]:["type",er(e,t)]}function ew(e,t){if(e.kind===M.a6.UnionExpression){let n=[],r=[];for(let a of e.options){let[e,o]=eM(a,t);"value"===e?n.push(o):r.push(o)}return{entityKind:"MixedParameterConstraint",node:e,valueType:0===n.length?void 0:1===n.length?n[0]:eh(e,n),type:0===r.length?void 0:1===r.length?r[0]:eh(e,r)}}{let[n,r]=eM(e,t);return{entityKind:"MixedParameterConstraint",node:e,type:"value"===n?void 0:r,valueType:"value"===n?r:void 0}}}function eI(e,t){let n=er(e.elementType,t),r=ee("Array").node,a=er(r.templateParameters[0]);return eT(r,[a],[n],{node:e,mapper:t},void 0)}function eE(e){(0,m.a7)(e.symbol,"Namespace is unbound.",e);let t=tu(e.symbol),n=eA(t);if(!n.type){let r=eP(e),a=e.id.sv,o=tl({kind:"Namespace",name:a,namespace:r,node:e,models:new Map,scalars:new Map,operations:new Map,namespaces:new Map,interfaces:new Map,unions:new Map,enums:new Map,decoratorDeclarations:new Map,functionDeclarations:new Map,decorators:[]});for(let e of(n.type=o,t.declarations))e.kind===M.a6.NamespaceStatement&&(o.decorators=o.decorators.concat(e2(o,e,void 0)));ts(o),r?.namespaces.set(a,o)}return n.type}function eP(e){if(e===B.node)return;if(e.kind===M.a6.ModelExpression||e.kind===M.a6.IntersectionExpression){let t=e.parent;for(;void 0!==t;)if(t.kind===M.a6.AliasStatement||t.kind===M.a6.ModelStatement||t.kind===M.a6.ScalarStatement||t.kind===M.a6.OperationStatement||t.kind===M.a6.EnumStatement||t.kind===M.a6.InterfaceStatement||t.kind===M.a6.UnionStatement||t.kind===M.a6.ModelExpression||t.kind===M.a6.IntersectionExpression)return eP(t);else t=t.parent;return}if(e.kind===M.a6.OperationStatement&&e.parent&&e.parent.kind===M.a6.InterfaceStatement)return eP(e.parent);if(!e.symbol.parent||e.symbol.parent.declarations[0].kind===M.a6.TypeSpecScript||e.symbol.parent.declarations[0].kind===M.a6.JsSourceFile)return B;let t=tu(e.symbol.parent),n=eA(t);if(!n.type){let r=t.declarations.find(e=>e.kind===M.a6.NamespaceStatement||e.kind===M.a6.JsNamespaceDeclaration);(0,m.a7)(r,"Can't find namespace declaration node.",e),n.type=eE(r)}return n.type}function eN(e,n,a){let o,i,l,d=e.parent?.kind===M.a6.InterfaceStatement,u=d?tr(e):e.symbol,c=u&&eA(u);if(c&&c.declaredType&&void 0===n)return c.declaredType;void 0===n&&d&&(0,m.a7)(a,"Operation in interface should already have been checked.",e.parent),eC(e,n),L(e)&&void 0!==n&&a&&(n={...n,partial:!0});let p=eP(e),f=e.id.sv,y=[],{resolvedSymbol:g}=t.resolveMetaMemberByName(u,"parameters");if(g?.members){let n=t.getAugmentedSymbolTable(g.members),r=function(e){if(void 0===e.docs)return new Map;let t=new Map;for(let n of e.docs)for(let e of n.tags)e.kind===M.a6.DocParamTag&&t.set(e.paramName.sv,U(e.content));return t}(e);for(let[e,t]of n){let n=r.get(e);n&&I.set(t,n)}}if(e.signature.kind===M.a6.OperationSignatureReference){let a=function(e,n,a){if(!n)return;let o=ec(e);o&&q.start(o,r.BaseType);let i=t.getNodeLinks(n).resolvedSymbol;if(i&&q.has(i,r.BaseType)){void 0===a&&Y((0,b.o)({code:"circular-op-signature",format:{typeName:i.name},target:n}));return}let l=er(n,a);if(o&&q.finish(o,r.BaseType),!(0,S.xg)(l))return"Operation"!==l.kind?void Y((0,b.o)({code:"is-operation",target:n})):l}(e,e.signature.baseOperation,n);if(a){l=a;let e=tc(a.parameters,{properties:(0,s.nQ)()});e.properties=(0,s.nQ)(Array.from(a.parameters.properties.entries()).map(([t,n])=>[t,tm(tn(g,n.name),n,{model:e,sourceProperty:n})])),o=ts(e),i=a.returnType,y=[...a.decorators]}else o=ti({kind:"Model",name:"",decorators:[],properties:(0,s.nQ)(),derivedModels:[],sourceModels:[]}),i=Q}else o=er(e.signature.parameters,n),i=er(e.signature.returnType,n);let v=tl({kind:"Operation",name:f,namespace:p,node:e,parameters:o,returnType:i,decorators:y,sourceOperation:l,interface:a});c&&et(c,v,n),y.push(...e2(v,e,n)),v.parameters.namespace=p;let k=e.parent;return D(v,n),k.kind===M.a6.InterfaceStatement?eB(k,n)&&eB(e,n)&&ts(v):(eB(e,n)&&ts(v),void 0===n&&p?.operations.set(f,v)),v}function eA(e){return t.getSymbolLinks(e)}function eV(e,t){let n=e.parent,r=eU(n,t,!1);return!r&&(0,h.qq)(n)&&void 0!==n.target&&(r=eU(n.target,t,!1)),r?.declarations.filter(e=>L(e))??[]}function eD(t){let n,r,a=e=>e?.kind===M.a6.ArrayLiteral||e?.kind===M.a6.ObjectLiteral,o=e=>e?.kind===M.a6.ModelExpression||e?.kind===M.a6.TupleExpression,i=[],l=(0,h._$)(t,e=>((function(e,t,n){if(e.kind===M.a6.ArrayLiteral||e.kind===M.a6.TupleExpression){let r=e.values.findIndex(e=>e===t);r>=0?n.unshift({tupleIndex:r}):(0,m.a7)(!1,"not expected, can't find child from the parent?")}(e.kind===M.a6.ModelProperty||e.kind===M.a6.ObjectLiteralProperty)&&n.unshift({propertyName:e.id.sv})})(e,n,i),n=e,(a(e)||o(e))&&(e.parent?.kind===M.a6.TemplateParameterDeclaration||e.parent?.kind===M.a6.TemplateArgument||e.parent?.kind===M.a6.DecoratorExpression)||a(e)&&(e.parent?.kind===M.a6.CallExpression||e.parent?.kind===M.a6.ConstStatement)));switch(l?.parent?.kind){case M.a6.TemplateParameterDeclaration:case M.a6.TemplateArgument:r=function(t){let n,r;if(t?.parent?.kind===M.a6.TemplateArgument&&t?.parent?.parent?.kind===M.a6.TypeReference){let e=t.parent,n=t.parent.parent,a=eV(e,void 0),o=n.arguments.findIndex(t=>t===e);a.length>0&&a[0].templateParameters.length>o&&(r=a[0].templateParameters[o])}else t.parent?.kind===M.a6.TemplateParameterDeclaration&&(r=t?.parent);if(r?.kind===M.a6.TemplateParameterDeclaration&&r.constraint)return a(t)&&r.constraint.kind===M.a6.ValueOfExpression?n=e.checker.getTypeForNode(r.constraint.target):o(t)&&r.constraint.kind!==M.a6.ValueOfExpression&&(n=e.checker.getTypeForNode(r.constraint)),n}(l);break;case M.a6.DecoratorExpression:r=function(t){let n,r=t?.parent;if(r?.kind!==M.a6.DecoratorExpression)return;let i=e.checker.resolveRelatedSymbols(r.target.kind===M.a6.MemberExpression?r.target.id:r.target);if(!i||i.length<=0)return;let l=i[0].declarations.find(e=>e.kind===M.a6.DecoratorDeclarationStatement);if(!l)return;let s=e.checker.getTypeForNode(l);(0,m.a7)("Decorator"===s.kind,"Expected type to be a Decorator.");let d=r.arguments.findIndex(e=>e===t);if(d<0||d>=s.parameters.length)return;let u=s.parameters[d];return a(t)?n=u.type.valueType:o(t)?n=u.type.type??u.type.valueType:(0,m.a7)(!1,"not expected node type to get reference model from decorator argument"),n}(l);break;case M.a6.CallExpression:r=function(e){let t=e?.parent;if(t?.kind!==M.a6.CallExpression)return;let n=eH(t,void 0);if(n?.kind!=="ScalarConstructor")return;let r=t.arguments.findIndex(t=>t===e);if(!(r<0)&&!(r>=n.parameters.length))return n.parameters[r].type}(l);break;case M.a6.ConstStatement:r=function(t){let n=t?.parent;if(n&&n.kind===M.a6.ConstStatement&&n.type&&n.value===t)return e.checker.getTypeForNode(n.type)}(l)}return function e(t,n){let r=t;if(r&&"Model"!==r.kind&&"Tuple"!==r.kind&&"Union"!==r.kind)return[];if(0===n.length)switch(r?.kind){case"Model":return[r];case"Union":let a=[];for(let t of r.variants.values())("Model"===t.type.kind||"Tuple"===t.type.kind||"Union"===t.type.kind)&&a.push(...e(t.type,n)??[]);return a;default:return[]}let o=n[0];switch(r?.kind){case"Tuple":if(void 0!==o.tupleIndex&&o.tupleIndex>=0&&o.tupleIndex<r.values.length)return e(r.values[o.tupleIndex],n.slice(1));return[];case"Model":if("Array"===r.name&&void 0!==o.tupleIndex)r=r.templateMapper?.args[0];else{if("Array"===r.name||!o.propertyName)return[];r=r.properties.get(o.propertyName)?.type}return e(r,n.slice(1));case"Union":let i=[];for(let t of r.variants.values())("Model"===t.type.kind||"Tuple"===t.type.kind||"Union"===t.type.kind)&&i.push(...e(t.type,n)??[]);return i;default:return[]}}(r,i)}function eU(n,r,a){let o="boolean"==typeof a?{...C,resolveDecorators:a}:{...C,...a??{}};if(void 0===r&&o.checkTemplateTypes&&P.has(n))return P.get(n);let i=function(n,r,a){if(!(0,h.qq)(n)){if(n.kind===M.a6.TypeReference)return eU(n.target,r,a);if(n.kind===M.a6.Identifier){let o=t.getNodeLinks(n);if(void 0===r&&o.resolutionResult)if(void 0===r&&o.resolutionResult&(M.lS.NotFound|M.lS.Unknown))Y((0,b.o)({code:"invalid-ref",messageId:a.resolveDecorators?"decorator":"identifier",format:{id:function e(t){switch(t.kind){case M.a6.MemberExpression:return`${e(t.base)}.${e(t.id)}`;case M.a6.TypeReference:return e(t.target);case M.a6.Identifier:return t.sv}}(n)},target:n,codefixes:"number"===n.sv?[(0,u.o)(n,"float64")]:void 0}));else o.resolutionResult&M.lS.Ambiguous&&function(t,n){let r=n.map(e=>(0,S.eN)(e,{useGlobalPrefixAtTopLevel:!0}));e.reportDiagnostic((0,b.o)({code:"ambiguous-symbol",format:{name:t.sv,duplicateNames:r.join(", ")},target:t}))}(n,o.ambiguousSymbols);let i=o.resolvedSymbol;return i?.symbolSource??i}if(n.kind===M.a6.MemberExpression){let e=eU(n.base,r,{...a,resolveDecorators:!1});if(!e)return;if(128&e.flags){let t=eO(e,r);if(!t)return void Y((0,b.o)({code:"invalid-ref",messageId:"node",format:{id:n.id.sv,nodeName:e.declarations[0]?M.a6[e.declarations[0].kind]:"Unknown node"},target:n}));e=t}var o=e,i=n,l=a;let{finalSymbol:s,resolvedSymbol:u}=t.resolveMemberExpressionForSym(o,i,l),c=u??s;if(c)return c;if(256&o.flags)Y((0,b.o)({code:"invalid-ref",messageId:"underNamespace",format:{namespace:(0,S.eN)(o),id:i.id.sv},target:i}));else if(512&o.flags)Y((0,b.o)({code:"invalid-ref",messageId:"inDecorator",format:{id:i.id.sv},target:i}));else if(2048&o.flags)Y((0,b.o)({code:"invalid-ref",messageId:"node",format:{id:i.id.sv,nodeName:"function"},target:i}));else if(118&o.flags)Y((0,b.o)({code:"invalid-ref",messageId:"."===i.selector?"member":"metaProperty",format:{kind:function(e){switch(e.kind){case M.a6.ModelStatement:case M.a6.ModelExpression:return"Model";case M.a6.ModelProperty:return"ModelProperty";case M.a6.EnumStatement:return"Enum";case M.a6.InterfaceStatement:return"Interface";case M.a6.UnionStatement:return"Union";default:return"Type"}}((0,d.gG)(o)),id:i.id.sv},target:i}));else{let e=(0,d.gG)(o);Y((0,b.o)({code:"invalid-ref",messageId:"node",format:{id:i.id.sv,nodeName:e?M.a6[e.kind]:"Unknown node"},target:i}))}return}(0,m.a7)(!1,`Unknown type reference kind "${M.a6[n.kind]}"`,n)}}(n,r,o);return o.checkTemplateTypes&&P.set(n,i),i}function eO(e,n){let r=(0,d.gG)(e),a=t.getSymbolLinks(e);if(!a.aliasResolutionIsTemplate)return a.aliasedSymbol??t.getNodeLinks(r).resolvedSymbol;let o=er(r,n);if(!(0,S.xg)(o))switch(o.kind){case"Model":case"Interface":case"Union":if((0,S.w7)(o))return e_(o),o.symbol;default:return tu(o.node.symbol)??e}}function eK(e){let t=i.get(e);if(t)return t;let n={entityKind:"Indeterminate",type:e};return i.set(e,n),n}function eL(e){return tl({kind:"StringTemplateSpan",node:e,isInterpolated:!1,type:td(e)})}function ej(e){for(let t of e.statements)eu(t,void 0)}function eC(e,t){if(void 0===t)for(let t of e.templateParameters)ef(t,void 0)}function eR(n,i){let l=eA(n.symbol);if(l.declaredType&&void 0===i)return l.declaredType;eC(n,i);let d=[],u=tl({kind:"Model",name:n.id.sv,node:n,properties:(0,s.nQ)(),namespace:eP(n),decorators:d,sourceModels:[],derivedModels:[]});if(et(l,u,i),n.symbol.members){let e=t.getAugmentedSymbolTable(n.symbol.members),r=function(e){if(void 0===e.docs)return new Map;let t=new Map;for(let n of e.docs)for(let e of n.tags)e.kind===M.a6.DocPropTag&&t.set(e.propName.sv,U(e.content));return t}(n);for(let[t,n]of e){let e=r.get(t);e&&I.set(n,e)}}let c=function(e,n,a){let o;if(!n)return;let i=ec(e);if(q.start(i,r.BaseType),n.kind===M.a6.ModelExpression)return void Y((0,b.o)({code:"is-model",messageId:"modelExpression",target:n}));if(n.kind===M.a6.ArrayExpression)o=eI(n,a);else{if(n.kind!==M.a6.TypeReference)return void Y((0,b.o)({code:"is-model",target:n}));let e=t.getNodeLinks(n).resolvedSymbol;if(e&&q.has(e,r.BaseType)){void 0===a&&Y((0,b.o)({code:"circular-base-type",format:{typeName:e.name},target:e}));return}o=er(n,a)}return(q.finish(i,r.BaseType),"Model"!==o.kind)?void Y((0,b.o)({code:"is-model",target:n})):""===o.name?void Y((0,b.o)({code:"is-model",messageId:"modelExpression",target:n})):o}(n,n.is,i);if(c&&(u.sourceModel=c,u.sourceModels.push({usage:"is",model:c}),d.push(...c.decorators),c.indexer&&(u.indexer=c.indexer)),c)for(let e of c.properties.values()){let t=tm(tn(n.symbol,e.name),e,{sourceProperty:e,model:u});eZ(n,t,i),u.properties.set(e.name,t)}c?u.baseModel=c.baseModel:n.extends&&(u.baseModel=function(n,a,o){if(a.kind===M.a6.ModelExpression)return void Y((0,b.o)({code:"extend-model",messageId:"modelExpression",target:a}));if(a.kind!==M.a6.TypeReference&&a.kind!==M.a6.ArrayExpression)return void Y((0,b.o)({code:"extend-model",target:a}));let i=ec(n);q.start(i,r.BaseType);let l=t.getNodeLinks(a).resolvedSymbol;if(l&&q.has(l,r.BaseType)){void 0===o&&Y((0,b.o)({code:"circular-base-type",format:{typeName:l.name},target:l}));return}let s=er(a,o);return(q.finish(i,r.BaseType),(0,S.xg)(s))?void(0,m.a7)(e.hasError(),"Should already have reported an error.",a):"Model"!==s.kind?void Y((0,b.o)({code:"extend-model",target:a})):(""===s.name&&Y((0,b.o)({code:"extend-model",messageId:"modelExpression",target:a})),s)}(n,n.extends,i),u.baseModel&&ev(u.baseModel,u)),u.baseModel&&u.baseModel.derivedModels.push(u),void 0===i&&u.namespace?.models.set(u.name,u),eQ(n,u.properties,u,i),d.push(...e2(u,n,i)),D(u,i),eB(n,i)&&ts(u);let p=(0,o.CT)(e,u);return"Array"===u.name&&em(u)?a.Array=u:"Record"===u.name&&em(u)&&(a.Record=u),p&&(u.indexer=p),e_(u),eY(u),u}function eB(e,t){return 0===e.templateParameters.length||void 0!==t&&!t.partial&&t.args.every(e=>(0,S.ml)(e)||"Indeterminate"===e.entityKind||"TemplateParameter"!==e.kind)}function eF(e,t,n){let r=function(e){let t=e;for(;t;){if(t.indexer)return t.indexer;t=t.baseModel}}(e);if(void 0!==r)return e$(r,t,n)}function e$(e,t,n){if("integer"===e.key.name)return void Z([(0,b.o)({code:"no-array-properties",target:n})]);let[r,a]=_.isTypeAssignableTo(t.type,e.value,n);r||Y((0,b.o)({code:"incompatible-indexer",format:{message:a.map(e=>`  ${e.message}`).join("\n")},target:n.kind===M.a6.ModelProperty?n.value:n}))}function eQ(t,n,r,a){let o;for(let i of t.properties)if("id"in i){let e=e0(i,a);e.model=r,eF(r,e,i),eW(n,e)}else{let[l,s]=function(t,n,r,a){let o=er(n,a);if("TemplateParameter"===o.kind||(0,S.xg)(o))return[[],void 0];if("Model"!==o.kind||(0,S.x3)(e,o))return Y((0,b.o)({code:"spread-model",target:n}),a),[[],void 0];r===o&&Y((0,b.o)({code:"spread-model",messageId:"selfSpread",target:n})),r.sourceModels.push({usage:"spread",model:o});let i=[];for(let e of A(o)){let n=tn(t,e.name);i.push(tm(n,e,{sourceProperty:e,model:r}))}return[i,o.indexer]}(t.symbol,i.target,r,a);for(let e of(s&&(o?o.push(s):o=[s]),l))eZ(t,e,a),eF(r,e,i),eW(n,e,i)}if(o){let e=1===o.length?o[0].value:function(e){let t=(0,s.nQ)(),n=ti({kind:"Union",node:void 0,options:e,decorators:[],variants:t,expression:!0});for(let r of e){let e=Symbol("indexer-union-variant");t.set(e,ti({kind:"UnionVariant",node:void 0,type:r,name:e,union:n,decorators:[]}))}return n}(o.map(e=>e.value));r.indexer={key:o[0].key,value:e}}}function ez(e,t){return N.set(e,t),e}function eG(e,t){let n={...e,...t},r=N.get(e);return r&&N.set(n,r),n}function eX(e,t){if(void 0!==e)switch(e.kind){case"Scalar":if((0,m.r$)(W.isTypeAssignableTo(t,e,t)))return e;return;case"Union":let n;for(let r of e.variants.values()){let e=eX(r.type,t);if(e)if(n)return void Y((0,b.o)({code:"ambiguous-scalar-type",format:{value:(0,v.Uz)(t),types:[n,e].map(e=>e.name).join(", "),example:n.name},target:t}));else n=e}return n;default:return}}function eq(e,t,n){let r;if(t&&!ty(e,t,n))return null;if("StringTemplate"===e.kind)if(!e.stringValue)return Z((0,y.D)(e)),null;else r=e.stringValue;else r=e.value;let a=eX(t?.type,e);return ez({entityKind:"Value",valueKind:"StringValue",value:r,type:t?t.type:e,scalar:a},e)}function eH(e,t){let n=ey(e.target,t);return"Scalar"===n.kind||"ScalarConstructor"===n.kind?n:(Y((0,b.o)({code:"non-callable",format:{type:n.kind},target:e.target})),null)}function eJ(e,t,n){if(1!==e.arguments.length)return Y((0,b.o)({code:"invalid-primitive-init",target:e.target})),null;let r=e.arguments[0],a=ea(r,void 0);return null===a?null:a.valueKind!==n?(Y((0,b.o)({code:"invalid-primitive-init",messageId:"invalidArg",format:{actual:a.valueKind,expected:n},target:r})),null):tg(a,t,r)?eG(a,{scalar:t,type:t}):null}function eW(e,t,n){if(e.has(t.name))return void Y((0,b.o)({code:"duplicate-property",format:{propName:t.name},target:n??t}));let r=function(e){(0,m.a7)(e.model,"Parent model must be set before overridden property can be found.");for(let t=e.model.baseModel;t;t=t.baseModel){let n=t.properties.get(e.name);if(n)return n}}(t);if(r){let[e,a]=_.isTypeAssignableTo(t.type,r.type,t),o=(0,v.Uz)(r.type),i=(0,v.Uz)(t.type),l=!1;if(e||(Y((0,b.o)({code:"override-property-mismatch",format:{propName:t.name,propType:i,parentType:o},target:n??t})),l=!0),!r.optional&&t.optional&&(Y((0,b.o)({code:"override-property-mismatch",messageId:"disallowedOptionalOverride",format:{propName:r.name},target:n??t})),l=!0),l)return}e.set(t.name,t)}function e_(e){if(!e.symbol)switch(e.kind){case"Model":e.symbol=(0,d.v5)(e.node,e.name,4194306),(0,s.Tk)(e.symbol).type=e;break;case"Interface":e.symbol=(0,d.v5)(e.node,e.name,4194336),(0,s.Tk)(e.symbol).type=e;break;case"Union":if(!e.name)return;e.symbol=(0,d.v5)(e.node,e.name,4194368),(0,s.Tk)(e.symbol).type=e}}function eY(e){(0,m.a7)(e.symbol,"Type must have a symbol to late bind members");let n=e.symbol;(0,m.a7)(n.members,"Container symbol didn't have members at late-bind");let r=t.getAugmentedSymbolTable(n.members);switch(e.kind){case"Model":for(let t of A(e))a(t,1114112);break;case"Scalar":for(let t of e.constructors.values())a(t,1114112);break;case"Enum":for(let t of e.members.values())a(t,1114112);break;case"Interface":for(let t of e.operations.values())a(t,1114120);break;case"Union":for(let t of e.variants.values())a(t,1114112)}function a(e,t){if(!e.node||"string"!=typeof e.name)return;let a=(0,d.v5)(e.node,e.name,4194304|t,n);(0,s.Tk)(a).type=e,(0,m.a7)(n.members,"containerSym.members is undefined"),r.set(e.name,a)}}function eZ(e,n,r){if(void 0!==r||((0,m.a7)("string"==typeof n.name,"Cannot link unmapped unions"),void 0===e.symbol))return;let a=tn(e.symbol,n.name);if(a){var o;o=t.getSymbolLinks(a),void 0===r&&(o.declaredType=n)}}function e0(e,t){let n=tr(e),a=ta(e);if(a&&a.declaredType&&void 0===t)return a.declaredType;let o=e.id.sv,i=tl({kind:"ModelProperty",name:o,node:e,optional:e.optional,type:void 0,decorators:[]});if(q.has(n,r.Type)&&void 0===t)Y((0,b.o)({code:"circular-prop",format:{propName:o},target:e})),i.type=$;else{if(q.start(n,r.Type),i.type=er(e.value,t),e.default){let n=function(e,t,n){if((0,S.xg)(t))return null;let r=ea(e,n,{kind:"assignment",type:t});if(null===r)return null;let[a,o]=_.isValueOfType(r,t,e);return a?"TemplateValue"===r.valueKind?null:{...r,type:t}:(Z(o),null)}(e.default,i.type,t);null!==n&&(i.defaultValue=n)}a&&et(a,i,t)}i.decorators=e2(i,e,t);let l=(0,S.hO)(e);if(D(i,t),!l||eB(l,t)){let e=I.get(n);e&&i.decorators.unshift(e6("self",e)),ts(i)}return q.finish(n,r.Type),i}function e6(e,t){return{decorator:o.DY,args:[{value:tf(e),jsValue:e},{value:tf(t),jsValue:t}]}}function e1(t,n,r){let a=eU(n.target,void 0,!0);if(!a)return;if(!(512&a.flags))return void Y((0,b.o)({code:"invalid-decorator",format:{id:a.name},target:n}));let o=eA(a),i=!1;if(void 0===o.declaredType){let e=a.declarations.find(e=>e.kind===M.a6.DecoratorDeclarationStatement);e&&ex(e,void 0)}o.declaredType&&((0,m.a7)("Decorator"===o.declaredType.kind,`Expected to find a decorator type but got ${o.declaredType.kind}`),!function(e,t,n){let[r]=_.isTypeAssignableTo(e,t.target.type,n);return r||Y((0,b.o)({code:"decorator-wrong-target",messageId:"withExpected",format:{decorator:t.name,to:(0,v.Uz)(e),expected:(0,v.He)(t.target.type)},target:n})),r}(t,o.declaredType,n)&&(i=!0));let[l,s]=function(t,n,r){if(void 0===r)return[!1,t.arguments.map(e=>{let t=eu(e,n)??$;return"Indeterminate"===t.entityKind&&(t=t.type),{value:t,jsValue:t,node:e}})];let a=!1,o=r.parameters.filter(e=>!e.optional&&!e.rest).length??0,i=r.parameters[r.parameters.length-1]?.rest?void 0:r.parameters.length;if(t.arguments.length<o||void 0!==i&&t.arguments.length>i)if(t.arguments.length<o&&(a=!0),void 0===i)Y((0,b.o)({code:"invalid-argument-count",messageId:"atLeast",format:{actual:t.arguments.length.toString(),expected:o.toString()},target:t}));else{let e=o===i?o.toString():`${o}-${i}`;Y((0,b.o)({code:"invalid-argument-count",format:{actual:t.arguments.length.toString(),expected:e},target:t}))}let l=[];function s(e,t){var r,a;let o=es(e,n,{kind:"argument",constraint:t});return null!==o&&!((0,S.Xj)(o)&&(0,S.xg)(o))&&e7(o,t,e)?{value:o,node:e,jsValue:(r=o,void 0!==(a=ed({kind:"argument",constraint:t}))&&(0,S.ml)(r)?(0,k.J)(r,a.type):r)}:void 0}for(let[n,o]of r.parameters.entries()){if(o.rest){let r=function(t){let n,r;if(t.valueType)if(!("Model"===t.valueType.kind&&(0,S.x3)(e,t.valueType)))return;else n=t.valueType.indexer.value;if(t.type)if(!("Model"===t.type.kind&&(0,S.x3)(e,t.type)))return;else r=t.type.indexer.value;return{entityKind:"MixedParameterConstraint",type:r,valueType:n}}(o.type);if(r)for(let e=n;e<t.arguments.length;e++){let n=t.arguments[e];if(n){let e=s(n,r);e?l.push(e):a=!0}}break}let r=t.arguments[n];if(r){let e=s(r,o.type);e?l.push(e):a=!0}}return[a,l]}(n,r,o.declaredType);if(!i&&!l)return{definition:o.declaredType,decorator:a.value??((...e)=>{}),node:n,args:s}}function e7(e,t,n){let[r]=_.isTypeAssignableTo(e,t,n);return r||Y((0,b.o)({code:"invalid-argument",format:{value:(0,v.He)(e),expected:(0,v.He)(t)},target:n})),r}function e4(e,n,r){let a=t.getAugmentDecoratorsForSym(e),o=[];for(let e of a){let t=e1(n,e,r);t&&o.unshift(t)}return o}function e2(e,n,r){var a;let o=(a=n).symbol&&65536&a.symbol.flags?tr(n)??n.symbol:tu(n.symbol),i=[];for(let a of[...t.getAugmentDecoratorsForSym(o),...n.decorators]){let t=e1(e,a,r);t&&i.unshift(t)}let l=function(e){if(e.node?.docs===void 0)return;let t="";for(let n of e.node.docs)t+=U(n.content);let n=t.trim();return""===n?void 0:n}(e);if(l&&i.unshift(e6("self",l)),"Operation"===e.kind){let t=function(e){let t={returns:void 0,errors:void 0};if(e.node?.docs===void 0)return t;for(let n of e.node.docs)for(let e of n.tags)e.kind===M.a6.DocReturnsTag&&(t.returns=U(e.content)),e.kind===M.a6.DocErrorsTag&&(t.errors=U(e.content));return t}(e);t.returns&&i.unshift(e6("returns",t.returns)),t.errors&&i.unshift(e6("errors",t.errors))}else e.kind;return i}function e5(n,o){let i=eA(n.symbol);if(i.declaredType&&void 0===o)return i.declaredType;eC(n,o);let l=[],s=tl({kind:"Scalar",name:n.id.sv,node:n,constructors:new Map,namespace:eP(n),decorators:l,derivedScalars:[]});return et(i,s,o),n.extends&&(s.baseScalar=function(n,a,o){let i=ec(n);q.start(i,r.BaseType);let l=t.getNodeLinks(a).resolvedSymbol;if(l&&q.has(l,r.BaseType)){void 0===o&&Y((0,b.o)({code:"circular-base-type",format:{typeName:l.declarations[0].id.sv},target:l}));return}let s=er(a,o);return(q.finish(i,r.BaseType),(0,S.xg)(s))?void(0,m.a7)(e.hasError(),"Should already have reported an error.",a):"Scalar"!==s.kind?void Y((0,b.o)({code:"extend-model",target:a})):s}(n,n.extends,o),s.baseScalar&&(ev(s.baseScalar,s),s.baseScalar.derivedScalars.push(s))),function(e,t,n,r){if(e.baseScalar)for(let a of e.baseScalar.constructors.values()){let o=tm(tn(t.symbol,a.name),{...a,scalar:e});eZ(t,o,r),n.set(a.name,o)}for(let a of t.members){let t=e3(a,r,e);if(n.has(t.name)){Y((0,b.o)({code:"constructor-duplicate",format:{name:t.name.toString()},target:a}));continue}n.set(t.name,t)}}(s,n,s.constructors,o),l.push(...e2(s,n,o)),void 0===o&&s.namespace?.scalars.set(s.name,s),D(s,o),eB(n,o)&&ts(s),em(s)&&(a[s.name]=s),s}function e3(e,t,n){let r=e.id.sv,a=ta(e);if(a&&a.declaredType&&void 0===t)return a.declaredType;let o=tl({kind:"ScalarConstructor",scalar:n,name:r,node:e,parameters:e.parameters.map(e=>eS(e,t,!1))});return D(o,t),eB(e.parent,t)&&ts(o),a&&et(a,o,t),ts(o)}function e8(e,t){let n=eA(e.symbol);if(n.declaredType&&void 0===t)return n.declaredType;eC(e,t);let a=ec(e);if(q.has(a,r.Type))return void 0===t&&Y((0,b.o)({code:"circular-alias-type",format:{typeName:e.id.sv},target:e})),n.declaredType=$,$;q.start(a,r.Type);let o=eu(e.value,t);return null===o?(n.declaredType=$,$):(0,S.ml)(o)?(Y((0,b.o)({code:"value-in-type",target:e.value})),n.declaredType=$,$):(et(n,o,t),q.finish(a,r.Type),o)}function e9(e,t){let n=eA(e.symbol);if(n.declaredType&&void 0===t)return n.declaredType;eC(e,t);let r=tl({kind:"Interface",decorators:[],node:e,namespace:eP(e),sourceInterfaces:[],operations:(0,s.nQ)(),name:e.id.sv});et(n,r,t),r.decorators=e2(r,e,t);let a=function(e,t,n){let r=new Map;for(let a of e.operations){let e=eN(a,t,n);if(r.has(e.name)){Y((0,b.o)({code:"interface-duplicate",format:{name:e.name},target:a}));continue}r.set(e.name,e)}return r}(e,t,r);for(let n of e.extends){let o=er(n,t);if("Interface"!==o.kind){Y((0,b.o)({code:"extends-interface",target:n}));continue}for(let i of o.operations.values()){r.operations.has(i.name)&&Y((0,b.o)({code:"extends-interface-duplicate",format:{name:i.name},target:n}));let o=tm(tn(e.symbol,i.name),i,{interface:r});a.has(i.name)||eZ(e,o,t),ev(i,o),r.operations.set(o.name,o)}r.sourceInterfaces.push(o)}for(let[e,t]of a)r.operations.set(e,t);return D(r,t),eB(e,t)&&ts(r),void 0===t&&r.namespace?.interfaces.set(r.name,r),e_(r),eY(r),r}function te(e,t){let n=eA(e.symbol);if(n.declaredType&&void 0===t)return n.declaredType;eC(e,t);let r=(0,s.nQ)(),a=tl({kind:"Union",decorators:[],node:e,namespace:eP(e),name:e.id.sv,variants:r,get options(){return Array.from(this.variants.values()).map(e=>e.type)},expression:!1});return et(n,a,t),a.decorators=e2(a,e,t),function(e,t,n,r){for(let a of t.options){let t=tt(a,r);if(t.union=e,n.has(t.name)){Y((0,b.o)({code:"union-duplicate",format:{name:t.name.toString()},target:a}));continue}n.set(t.name,t)}}(a,e,r,t),D(a,t),eB(e,t)&&ts(a),void 0===t&&a.namespace?.unions.set(a.name,a),e_(a),eY(a),a}function tt(e,t){let n=ta(e);if(n&&n.declaredType&&void 0===t)return n.declaredType;let r=e.id?e.id.sv:Symbol("name"),a=er(e.value,t),o=tl({kind:"UnionVariant",name:r,node:e,decorators:[],type:a,union:void 0});return o.decorators=e2(o,e,t),D(o,t),eB(e.parent,t)&&ts(o),n&&et(n,o,t),o}function tn(e,n){return e?t.getAugmentedSymbolTable(e.members).get(n):void 0}function tr(e){if(!e.id)return;let t=e.id.sv,n=e.parent?.symbol;return n?tn(n,t):void 0}function ta(e){let t=tr(e);return t&&(0,d.gG)(t)===e?eA(t):void 0}function to(e,t,n){let r=e.id.sv,a=ta(e);if(a?.type)return a.type;(0,m.a7)(n,"Enum member should already have been checked.");let o=e.value?e.value.value:void 0,i=tl({kind:"EnumMember",enum:n,name:r,node:e,value:o,decorators:[]});return a&&(a.type=i),i.decorators=e2(i,e,t),ts(i)}function ti(e){return tl(e),ts(e)}function tl(t){return n.createdTypes++,Object.setPrototypeOf(t,R),t.isFinished=!1,t.entityKind="Type",t.node&&function(t,n){let r=!1;for(let a of t.directives??[])if("deprecated"===a.target.sv){let o,i=a.arguments[0];if(void 0===i){Y((0,b.o)({code:"invalid-deprecation-argument",messageId:"missing",target:a}));continue}i.kind!==M.a6.StringLiteral?(Y((0,b.o)({code:"invalid-deprecation-argument",format:{kind:M.a6[i.kind]},target:a.arguments[0]})),o="<missing message>"):o=i.value,!0===r?Y((0,b.o)({code:"duplicate-deprecation",target:t})):(r=!0,(0,p.BG)(e,n,{message:o}))}}(t.node,t),t}function ts(t){return n.finishedTypes++,O(e,R,t)}function td(e){return tf(e.value,e)}function tu(e){return t.getMergedSymbol(e)}function tc(e,t){let n;switch(e.kind){case"Model":let r=tl({...e,decorators:[...e.decorators],properties:void 0,...t});"properties"in t||(r.properties=(0,s.nQ)(Array.from(e.properties.entries()).map(([e,t])=>[e,tp(t,{model:r})]))),n=r;break;case"Union":let a=tl({...e,decorators:[...e.decorators],variants:void 0,get options(){return Array.from(this.variants.values()).map(e=>e.type)},...t});"variants"in t||(a.variants=(0,s.nQ)(Array.from(e.variants.entries()).map(([e,t])=>[e,tp(t,{union:a})]))),n=a;break;case"Interface":let o=tl({...e,decorators:[...e.decorators],operations:void 0,...t});"operations"in t||(o.operations=(0,s.nQ)(Array.from(e.operations.entries()).map(([e,t])=>[e,tp(t,{interface:o})]))),n=o;break;case"Enum":let i=tl({...e,decorators:[...e.decorators],members:void 0,...t});"members"in t||(i.members=(0,s.nQ)(Array.from(e.members.entries()).map(([e,t])=>[e,tp(t,{enum:i})]))),n=i;break;default:n=tl({...e,..."decorators"in e?{decorators:[...e.decorators]}:{},...t})}return n}function tp(e,t={}){let n=tc(e,t);return e.isFinished&&(n=ts(n)),(0,m.a7)(n.kind===e.kind,"cloneType must not change type kind"),n}function tm(e,t,n={}){let r=tc(t,n);if("decorators"in r){let t=I.get(e);for(let n of(t&&r.decorators.push(e6("self",t)),e4(e,r,void 0)))r.decorators.push(n)}return t.isFinished&&(r=ts(r)),(0,m.a7)(r.kind===t.kind,"cloneType must not change type kind"),r}function tf(t,n){let r,a;if(e.literalTypes.has(t))return e.literalTypes.get(t);switch(typeof t){case"string":r=tl({kind:"String",value:t});break;case"boolean":r=tl({kind:"Boolean",value:t});break;case"number":n?((0,m.a7)(n.kind===M.a6.NumericLiteral,"Must pass numeric literal node or undefined when creating a numeric literal type"),a=n.valueAsString):a=String(t),r=tl({kind:"Number",value:t,valueAsString:a,numericValue:(0,T.ew)(a)})}return e.literalTypes.set(t,r),r}function ty(e,t,n){let[r,a]=_.isTypeAssignableTo(e,t.type,n);return r||("argument"===t.kind?Y((0,b.o)({code:"invalid-argument",format:{value:(0,v.He)(e),expected:(0,v.He)(t.type)},target:n})):Z(a)),r}function tg(e,t,n){let[r,a]=_.isValueOfType(e,t,n);return r||Z(a),r}}function E(e,t,n,r){let a=new Map(r?.map??[]);for(let[n,r]of e.entries())a.set(r,t[n]);return{partial:!1,args:[...r?.args??[],...t],getMappedType:e=>a.get(e)??e,source:n,map:a}}function P(e,t,n){let r,a;if(n&&(t=N(e,t,n)),t.name||((0,m.a7)(!t.baseModel,"Anonymous model with base model."),0===t.properties.size))return t;for(let e of t.properties.values()){let n=function(e){if(!e.sourceProperty)return;let t=new Set;for(let n=e;n;n=n.sourceProperty)n.model?.name&&t.add(n.model);return t}(e);if(!n)return t;if(!r){r=n;continue}for(let e of r)if(!n.has(e)){for(let t=e.baseModel;t;t=t.baseModel)if(n.has(t)){n.add(e);break}}for(let e of r)n.has(e)||r.delete(e)}for(let e of r??[]){if(t.properties.size===V(e)){a=e;break}if(n&&!a&&t.properties.size===V(e,n)){a=e;continue}}return a??t}function N(e,t,n){var r,o;let l=!1;for(let e of A(t))if(!n(e)){l=!0;break}if(!l)return t;let s=a.M.realmForType.get(t),d=s?(0,i.$)(s):(0,i.$)(e),u=d.model.create({name:"",indexer:void 0,properties:{},decorators:[],derivedModels:[],sourceModels:[{usage:"spread",model:t}]});for(let e of A(t))if(n(e)){let t=d.type.clone(e);Object.assign(t,{sourceProperty:e,model:u}),u.properties.set(e.name,t),d.type.finishType(t)}return r=e,o=u,O(r,r.checker.typePrototype,o)}function*A(e){let t=new Set;for(let n=e;n;n=n.baseModel)for(let e of n.properties.values())t.has(e.name)||(t.add(e.name),yield e)}function V(e,t){let n=0;for(let r of A(e))(!t||t(r))&&n++;return n}function D(e,t){t&&((0,m.a7)(!e.templateMapper,"Mapper provided but template arguments already set."),e.templateMapper=t)}function U(e){let t=[];for(let n of e)(0,m.a7)(n.kind===M.a6.DocText,"No other doc content node kinds exist yet. Update this code appropriately when more are added."),t.push(n.text);return t.join("")}function O(e,t,n){if("decorators"in n)for(let t of n.decorators)!function(e,t,n){for(let e of((0,m.a7)("decorators"in n,"Cannot apply decorator to non-decoratable type",n),t.args))if((0,S.Xj)(e.value)&&(0,S.xg)(e.value))return;if(t.definition){let r=(0,p.LA)(e,t.definition);void 0!==r&&K(e,t.node??n,r.message,e.reportDiagnostic)}try{let r=t.args.map(e=>e.jsValue),a=t.decorator,o=function(e,t){return{program:e,decoratorTarget:t.node,getArgumentTarget:e=>t.args[e]?.node,call:(n,r,...a)=>n(function e(t,n){return{program:t,decoratorTarget:n.node,getArgumentTarget:()=>n.node,call:(r,a,...o)=>r(e(t,n),a,...o)}}(e,t),r,...a)}}(e,t);a(o,n,...r)}catch(r){if(e.compilerOptions.designTimeBuild)e.reportDiagnostic((0,b.o)({code:"decorator-fail",format:{decoratorName:t.decorator.name,error:r.stack},target:t.node??n}));else throw r}}(e,t,n);return Object.setPrototypeOf(n,t),n.isFinished=!0,n}function K(e,t,n,r){!0!==e.compilerOptions.ignoreDeprecated&&r((0,b.o)({code:"deprecated",format:{message:n},target:t}))}function L(e){return"templateParameters"in e&&e.templateParameters.length>0}!function(e){e[e.Value=0]="Value",e[e.Type=1]="Type",e[e.BaseType=2]="BaseType",e[e.Constraint=3]="Constraint"}(r||(r={}));class j{#e=new Map;start(e,t){let n=this.#e.get(e);void 0===n&&(n=new Set,this.#e.set(e,n)),n.add(t)}has(e,t){return this.#e.get(e)?.has(t)??!1}finish(e,t){let n=this.#e.get(e);void 0!==n&&(n?.delete(t),0===n.size&&this.#e.delete(e))}}let C={resolveDecorators:!1,checkTemplateTypes:!0}}}]);