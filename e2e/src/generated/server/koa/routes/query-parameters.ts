/** AUTOGENERATED - DO NOT EDIT **/
/* tslint:disable */
/* eslint-disable */

import KoaRouter, {type RouterContext} from "@koa/router"
import {RequestInputType} from "@nahkies/typescript-koa-runtime/errors"
import {
  handleImplementationError,
  handleResponse,
  type KoaRuntimeResponder,
  KoaRuntimeResponse,
  type Params,
  parseQueryParameters,
  type Res,
  type SkipResponse,
  type StatusCode,
} from "@nahkies/typescript-koa-runtime/server"
import {
  parseRequestInput,
  responseValidationFactory,
} from "@nahkies/typescript-koa-runtime/zod-v4"
import type {Next} from "koa"
import {z} from "zod/v4"
import type {
  t_GetParamsDefaultObjectQuery200Response,
  t_GetParamsDefaultObjectQueryQuerySchema,
  t_GetParamsMixedQuery200Response,
  t_GetParamsMixedQueryQuerySchema,
  t_GetParamsSimpleQuery200Response,
  t_GetParamsSimpleQueryQuerySchema,
  t_GetParamsUnexplodedObjectQuery200Response,
  t_GetParamsUnexplodedObjectQueryQuerySchema,
} from "../models.ts"
import {
  s_GetParamsDefaultObjectQuery200Response,
  s_GetParamsMixedQuery200Response,
  s_GetParamsSimpleQuery200Response,
  s_GetParamsUnexplodedObjectQuery200Response,
} from "../schemas.ts"

export type GetParamsSimpleQueryResponder = {
  with200(): KoaRuntimeResponse<t_GetParamsSimpleQuery200Response>
} & KoaRuntimeResponder

export type GetParamsSimpleQuery = (
  params: Params<void, t_GetParamsSimpleQueryQuerySchema, void, void>,
  respond: GetParamsSimpleQueryResponder,
  ctx: RouterContext,
  next: Next,
) => Promise<
  | KoaRuntimeResponse<unknown>
  | Res<200, t_GetParamsSimpleQuery200Response>
  | typeof SkipResponse
>

export type GetParamsDefaultObjectQueryResponder = {
  with200(): KoaRuntimeResponse<t_GetParamsDefaultObjectQuery200Response>
} & KoaRuntimeResponder

export type GetParamsDefaultObjectQuery = (
  params: Params<void, t_GetParamsDefaultObjectQueryQuerySchema, void, void>,
  respond: GetParamsDefaultObjectQueryResponder,
  ctx: RouterContext,
  next: Next,
) => Promise<
  | KoaRuntimeResponse<unknown>
  | Res<200, t_GetParamsDefaultObjectQuery200Response>
  | typeof SkipResponse
>

export type GetParamsUnexplodedObjectQueryResponder = {
  with200(): KoaRuntimeResponse<t_GetParamsUnexplodedObjectQuery200Response>
} & KoaRuntimeResponder

export type GetParamsUnexplodedObjectQuery = (
  params: Params<void, t_GetParamsUnexplodedObjectQueryQuerySchema, void, void>,
  respond: GetParamsUnexplodedObjectQueryResponder,
  ctx: RouterContext,
  next: Next,
) => Promise<
  | KoaRuntimeResponse<unknown>
  | Res<200, t_GetParamsUnexplodedObjectQuery200Response>
  | typeof SkipResponse
>

export type GetParamsMixedQueryResponder = {
  with200(): KoaRuntimeResponse<t_GetParamsMixedQuery200Response>
} & KoaRuntimeResponder

export type GetParamsMixedQuery = (
  params: Params<void, t_GetParamsMixedQueryQuerySchema, void, void>,
  respond: GetParamsMixedQueryResponder,
  ctx: RouterContext,
  next: Next,
) => Promise<
  | KoaRuntimeResponse<unknown>
  | Res<200, t_GetParamsMixedQuery200Response>
  | typeof SkipResponse
>

export type QueryParametersImplementation = {
  getParamsSimpleQuery: GetParamsSimpleQuery
  getParamsDefaultObjectQuery: GetParamsDefaultObjectQuery
  getParamsUnexplodedObjectQuery: GetParamsUnexplodedObjectQuery
  getParamsMixedQuery: GetParamsMixedQuery
}

export function createQueryParametersRouter(
  implementation: QueryParametersImplementation,
): KoaRouter {
  const router = new KoaRouter()

  const getParamsSimpleQueryQuerySchema = z.object({
    orderBy: z.enum(["asc", "desc"]),
    limit: z.coerce.number(),
  })

  const getParamsSimpleQueryResponseValidator = responseValidationFactory(
    [["200", s_GetParamsSimpleQuery200Response]],
    undefined,
  )

  router.get(
    "getParamsSimpleQuery",
    "/params/simple-query",
    async (ctx, next) => {
      const input = {
        params: undefined,
        query: parseRequestInput(
          getParamsSimpleQueryQuerySchema,
          ctx.query,
          RequestInputType.QueryString,
        ),
        body: undefined,
        headers: undefined,
      }

      const responder = {
        with200() {
          return new KoaRuntimeResponse<t_GetParamsSimpleQuery200Response>(200)
        },
        withStatus(status: StatusCode) {
          return new KoaRuntimeResponse(status)
        },
      }

      await implementation
        .getParamsSimpleQuery(input, responder, ctx, next)
        .catch(handleImplementationError)
        .then(handleResponse(ctx, next, getParamsSimpleQueryResponseValidator))
    },
  )

  const getParamsDefaultObjectQueryQuerySchema = z.object({
    filter: z.object({name: z.string(), age: z.coerce.number()}),
  })

  const getParamsDefaultObjectQueryResponseValidator =
    responseValidationFactory(
      [["200", s_GetParamsDefaultObjectQuery200Response]],
      undefined,
    )

  router.get(
    "getParamsDefaultObjectQuery",
    "/params/default-object-query",
    async (ctx, next) => {
      const input = {
        params: undefined,
        query: parseRequestInput(
          getParamsDefaultObjectQueryQuerySchema,
          parseQueryParameters(ctx.querystring, [
            {
              name: "filter",
              explode: true,
              style: "form",
              schema: {
                type: "object",
                properties: {name: {type: "string"}, age: {type: "number"}},
              },
            },
          ]),
          RequestInputType.QueryString,
        ),
        body: undefined,
        headers: undefined,
      }

      const responder = {
        with200() {
          return new KoaRuntimeResponse<t_GetParamsDefaultObjectQuery200Response>(
            200,
          )
        },
        withStatus(status: StatusCode) {
          return new KoaRuntimeResponse(status)
        },
      }

      await implementation
        .getParamsDefaultObjectQuery(input, responder, ctx, next)
        .catch(handleImplementationError)
        .then(
          handleResponse(
            ctx,
            next,
            getParamsDefaultObjectQueryResponseValidator,
          ),
        )
    },
  )

  const getParamsUnexplodedObjectQueryQuerySchema = z.object({
    filter: z.object({name: z.string(), age: z.coerce.number()}),
  })

  const getParamsUnexplodedObjectQueryResponseValidator =
    responseValidationFactory(
      [["200", s_GetParamsUnexplodedObjectQuery200Response]],
      undefined,
    )

  router.get(
    "getParamsUnexplodedObjectQuery",
    "/params/unexploded-object-query",
    async (ctx, next) => {
      const input = {
        params: undefined,
        query: parseRequestInput(
          getParamsUnexplodedObjectQueryQuerySchema,
          parseQueryParameters(ctx.querystring, [
            {
              name: "filter",
              explode: false,
              style: "form",
              schema: {
                type: "object",
                properties: {name: {type: "string"}, age: {type: "number"}},
              },
            },
          ]),
          RequestInputType.QueryString,
        ),
        body: undefined,
        headers: undefined,
      }

      const responder = {
        with200() {
          return new KoaRuntimeResponse<t_GetParamsUnexplodedObjectQuery200Response>(
            200,
          )
        },
        withStatus(status: StatusCode) {
          return new KoaRuntimeResponse(status)
        },
      }

      await implementation
        .getParamsUnexplodedObjectQuery(input, responder, ctx, next)
        .catch(handleImplementationError)
        .then(
          handleResponse(
            ctx,
            next,
            getParamsUnexplodedObjectQueryResponseValidator,
          ),
        )
    },
  )

  const getParamsMixedQueryQuerySchema = z.object({
    limit: z.coerce.number(),
    statuses: z.preprocess(
      (it: unknown) => (Array.isArray(it) || it === undefined ? it : [it]),
      z.array(z.enum(["open", "closed"])),
    ),
  })

  const getParamsMixedQueryResponseValidator = responseValidationFactory(
    [["200", s_GetParamsMixedQuery200Response]],
    undefined,
  )

  router.get(
    "getParamsMixedQuery",
    "/params/mixed-query",
    async (ctx, next) => {
      const input = {
        params: undefined,
        query: parseRequestInput(
          getParamsMixedQueryQuerySchema,
          ctx.query,
          RequestInputType.QueryString,
        ),
        body: undefined,
        headers: undefined,
      }

      const responder = {
        with200() {
          return new KoaRuntimeResponse<t_GetParamsMixedQuery200Response>(200)
        },
        withStatus(status: StatusCode) {
          return new KoaRuntimeResponse(status)
        },
      }

      await implementation
        .getParamsMixedQuery(input, responder, ctx, next)
        .catch(handleImplementationError)
        .then(handleResponse(ctx, next, getParamsMixedQueryResponseValidator))
    },
  )

  return router
}

export {createQueryParametersRouter as createRouter}
export type {QueryParametersImplementation as Implementation}
